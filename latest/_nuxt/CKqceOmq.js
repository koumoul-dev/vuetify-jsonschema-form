import{Y as P}from"./D8Oal-HQ.js";import{P as B}from"./CN5uW8HJ.js";import{P as X}from"./hxxMZaLm.js";import{d as Z,V as h}from"./CeyS0tgl.js";import{r as v,ab as j,t as c,D as g,A as r,z as o,E as a,B as k,F as N,K as z,o as M,i as $,aI as ee,aM as ae,v as te,J as le,I as oe,x as Y,y as J,a0 as re}from"./DDO8QKIb.js";import{V as A}from"./CZPf-SqO.js";import{V as H,a as se,b as T,c as ue}from"./Ca2puSKV.js";import{w as ne,u as ie,a as de}from"./D8Z151pl.js";import{b as me,_ as ve,d as pe}from"./Cg4gCveX.js";import{a as D,V as F,b as _}from"./C40M9ten.js";import{e as fe,a as ce,V as I}from"./DSfuRALh.js";import{u as ye}from"./DsCoG0-g.js";import{V as W}from"./DrxVZ_FA.js";import{d as ge}from"./hej_B3NW.js";import{V as Ve}from"./Be3QNnqU.js";import"./BosuxZz1.js";import"./DZxj2y-G.js";import"./Dd9xnyj6.js";import"./D3RJgXsT.js";import"./BxpcBM4N.js";import"./CFY9ywFx.js";import"./D0jGGK69.js";import"./CvUd-P3a.js";/* empty css        */const he={__name:"object-editor",props:{modelValue:{type:[Object,String,Number,Boolean,Array],required:!0},readonly:{type:Boolean,default:!1},defaultLanguage:{type:String,default:"json"}},emits:["update:modelValue","update:parseError"],setup(E,{emit:x}){B.manual=!0;const u=E,n=x,s=v({}),d=v(u.defaultLanguage),y=v("{}"),p=(i,l)=>(l=l??d.value,l==="yaml"?P.parse(i):JSON.parse(i)),w=(i,l)=>(l=l??d.value,l==="yaml"?P.stringify(i):JSON.stringify(i,null,2));j(d,()=>{y.value=w(s.value)});const U=i=>{try{s.value=p(i),n("update:modelValue",s.value),n("update:parseError",null)}catch(l){n("update:parseError",l.message)}};j(()=>u.modelValue,()=>{u.modelValue!==s.value&&(s.value=JSON.parse(JSON.stringify(u.modelValue)),y.value=w(s.value))},{immediate:!0});const V=i=>B.highlight(i,B.languages[d.value],d.value);return(i,l)=>(c(),g(a(H),{style:{position:"relative","background-color":"white"}},{default:r(()=>[o(a(Z),{class:"rounded-0 rounded-bs-xl",rounded:"bs",density:"compact",variant:"elevated",elevation:"1",style:{position:"absolute",top:"0",right:"0","z-index":"200",height:"24px"}},{default:r(()=>[o(a(h),{size:"small",color:d.value==="json"?"primary":"",onClick:l[0]||(l[0]=f=>d.value="json")},{default:r(()=>l[4]||(l[4]=[k(" JSON ")])),_:1},8,["color"]),o(a(h),{size:"small",color:d.value==="yaml"?"primary":"",onClick:l[1]||(l[1]=f=>d.value="yaml")},{default:r(()=>l[5]||(l[5]=[k(" YAML ")])),_:1},8,["color"]),E.readonly?N("",!0):(c(),g(a(h),{key:0,size:"small",onClick:l[2]||(l[2]=f=>y.value=w(s.value))},{default:r(()=>[o(a(A),null,{default:r(()=>l[6]||(l[6]=[k("mdi-format-align-left")])),_:1})]),_:1}))]),_:1}),o(a(X),{modelValue:y.value,"onUpdate:modelValue":[l[3]||(l[3]=f=>y.value=f),U],class:"vjsf-code-editor py-2",style:z(`min-height:200px; background-color: ${i.$vuetify.theme.current.colors.background}`),highlight:V,"line-numbers":"",readonly:E.readonly},null,8,["modelValue","style","readonly"])]),_:1}))}},ke={class:"text-caption"},xe=["value","onInput"],He={__name:"editor",setup(E){const x=fe[0].examples[0],u=v(null),n=v(null),s=v(null),d=v("light");M(()=>{const m=window.localStorage.getItem("vjsf-editor-state");if(m){const e=JSON.parse(m);u.value=e.schema,n.value=e.options??{},s.value=e.data??{}}else u.value=x.schema,n.value=x.options??{},s.value=x.data??{};ne([u,n,s],()=>{window.localStorage.setItem("vjsf-editor-state",JSON.stringify({schema:u.value,options:n.value,data:s.value}))},{debounce:500,immediate:!0})});const y=[{value:"schema",title:"Schema"},{value:"options",title:"Options"},{value:"data",title:"Data"}],p=v("schema"),{height:w}=ie(),U=$(()=>w.value-56),V=v({}),i=v(null);j([u,n],()=>{if(!n.value||!u.value)return;let m;try{m=pe(u.value,{...de,...n.value,components:{[_.info.name]:_.info}}),V.value=m.validationErrors}catch(e){V.value={"":[e.message]}}Object.keys(V.value).length||(i.value={options:{...n.value,plugins:[_]},schema:u.value})},{immediate:!0});const l=ee({}),f=(m,e)=>{e?l[m]=e:delete l[m]},C=$(()=>{const m={...l,...V.value};return Object.keys(m).length?P.stringify(m).trim():""}),L=v(null),S=v(null),q=$(()=>S.value===!1?"error":S.value===!0?"success":"default"),G=()=>{d.value=d.value==="light"?"dark":"light"},K=m=>{},R=m=>{};return j(S,()=>{}),ye({title:"VJSF - Editor"}),M(()=>{document.getElementsByTagName("html")[0].style.overflowY="hidden"}),ae(()=>{document.getElementsByTagName("html")[0].style.overflowY=""}),(m,e)=>{const O=he;return n.value&&s.value!==void 0?(c(),g(a(Ve),{key:0,fluid:"",class:"pa-0"},{default:r(()=>[o(a(F),{dense:""},{default:r(()=>[o(a(D),{class:"ml-2"},{default:r(()=>[o(a(W),{variant:"outlined",color:C.value?"error":"grey",class:"pa-0",style:z(`max-height: ${U.value-8}px;overflow-y: auto;`)},{default:r(()=>[o(a(ce),{density:"compact",color:"surface"},{default:r(()=>[(c(),te(oe,null,le(y,t=>o(a(h),{key:t.value,class:"text-none font-weight-bold ml-2",variant:p.value===t.value?"flat":"text",active:p.value===t.value,color:p.value===t.value?"primary":"",onClick:b=>p.value=t.value},{default:r(()=>[k(J(t.title),1)]),_:2},1032,["variant","active","color","onClick"])),64)),o(a(I)),o(a(h),{icon:"",color:"primary",class:"mr-2",onClick:G},{default:r(()=>[d.value==="light"?(c(),g(a(A),{key:0,icon:"mdi-weather-night"})):(c(),g(a(A),{key:1,icon:"mdi-weather-sunny"}))]),_:1})]),_:1}),o(a(ge)),o(a(se),{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t)},{default:r(()=>[o(a(T),{value:"schema"},{default:r(()=>[o(O,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),"default-language":"yaml","onUpdate:parseError":e[1]||(e[1]=t=>f("schema",t))},null,8,["modelValue"])]),_:1}),o(a(T),{value:"options"},{default:r(()=>[o(O,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value=t),"default-language":"yaml","onUpdate:parseError":e[3]||(e[3]=t=>f("options",t))},null,8,["modelValue"])]),_:1}),o(a(T),{value:"data"},{default:r(()=>[o(O,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value=t),"onUpdate:parseError":e[5]||(e[5]=t=>f("schema",t))},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),C.value?(c(),g(a(W),{key:0,color:"error",variant:"text",class:"pa-2"},{default:r(()=>[Y("pre",ke,J(C.value),1)]),_:1})):N("",!0)]),_:1},8,["color","style"])]),_:1}),o(a(D),{class:"pr-3"},{default:r(()=>[o(a(H),{style:z(`max-height: ${U.value-8}px;overflow-y: auto;`),rounded:"",border:"sm"},{default:r(()=>[o(a(ue),{theme:d.value,"with-background":""},{default:r(()=>[i.value?(c(),g(a(me),{key:0,ref_key:"form",ref:L,modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=t=>S.value=t),class:"mx-3 mt-3"},{default:r(()=>[o(a(ve),re({modelValue:s.value,"onUpdate:modelValue":e[7]||(e[7]=t=>s.value=t)},i.value,{"onUpdate:state":R,"onUpdate:modelValue":K}),{"custom-textarea":r(({node:t,statefulLayout:b})=>[Y("textarea",{value:t.data,style:{border:"1px solid red"},placeholder:"A custom textarea",onInput:Q=>b.input(t,Q.target.value)},null,40,xe)]),"custom-message":r(({node:t})=>[k(" This message is defined in a slot (key="+J(t.key)+") ",1)]),_:1},16,["modelValue"]),o(a(F),{class:"ma-0"},{default:r(()=>[o(a(I)),o(a(h),{color:q.value,flat:"",class:"my-2",onClick:e[8]||(e[8]=t=>{var b;return(b=L.value)==null?void 0:b.validate()})},{default:r(()=>e[10]||(e[10]=[k(" Validate ")])),_:1},8,["color"])]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),_:1},8,["theme"])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})):N("",!0)}}};export{He as default};
