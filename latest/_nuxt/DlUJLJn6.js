import{d as De,h as A,aO as we}from"./Db_1TMCl.js";import{d as Pe}from"./C0rtkL2H.js";import{v as le,a as fe,i as Ce,b as ue,c as _e,d as Ee,e as Se,g as Ke,f as xe,h as Ae,j as Le,k as Te,l as Y,m as ae,o as Me,p as qe,q as Re,r as Be,s as Ve}from"./rESElKdt.js";import{a as He,c as Ye,d as Ge}from"./DIu7GdWc.js";import{p as w,b as V}from"./CHo-MoSC.js";import{e as ze}from"./kY6r_Lxp.js";function B(){return B=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},B.apply(this,arguments)}var We=13,Ue=9,Qe=8,Ze=89,G=90,Xe=77,ce=57,de=219,pe=222,ye=192,Je=27,me=100,Ne=3e3,Fe=typeof window<"u"&&navigator&&/Win/i.test(navigator.platform),W=typeof window<"u"&&navigator&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),$t=De({props:{lineNumbers:{type:Boolean,default:!1},autoStyleLineNumbers:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},modelValue:{type:String,default:""},highlight:{type:Function,required:!0},tabSize:{type:Number,default:2},insertSpaces:{type:Boolean,default:!0},ignoreTabKey:{type:Boolean,default:!1},placeholder:{type:String,default:""}},data:function(){return{capture:!0,history:{stack:[],offset:-1},lineNumbersHeight:"20px",codeData:""}},watch:{modelValue:{immediate:!0,handler:function(i){i?this.codeData=i:this.codeData=""}},content:{immediate:!0,handler:function(){var i=this;this.lineNumbers&&this.$nextTick(function(){i.setLineNumbersHeight()})}},lineNumbers:function(){var i=this;this.$nextTick(function(){i.styleLineNumbers(),i.setLineNumbersHeight()})}},computed:{isEmpty:function(){return this.codeData.length===0},content:function(){var i=this.highlight(this.codeData)+"<br />";return i},lineNumbersCount:function(){var i=this.codeData.split(/\r\n|\n/).length;return i}},mounted:function(){this._recordCurrentState(),this.styleLineNumbers()},methods:{setLineNumbersHeight:function(){this.lineNumbersHeight=getComputedStyle(this.$refs.pre).height},styleLineNumbers:function(){if(!(!this.lineNumbers||!this.autoStyleLineNumbers)){var i=this.$refs.pre,t=this.$el.querySelector(".prism-editor__line-numbers"),n=window.getComputedStyle(i);this.$nextTick(function(){var o="border-top-left-radius",s="border-bottom-left-radius";if(t){t.style[o]=n[o],t.style[s]=n[s],i.style[o]="0",i.style[s]="0";var f=["background-color","margin-top","padding-top","font-family","font-size","line-height"];f.forEach(function(a){t.style[a]=n[a]}),t.style["margin-bottom"]="-"+n["padding-top"]}})}},_recordCurrentState:function(){var i=this.$refs.textarea;if(i){var t=i.value,n=i.selectionStart,o=i.selectionEnd;this._recordChange({value:t,selectionStart:n,selectionEnd:o})}},_getLines:function(i,t){return i.substring(0,t).split(`
`)},_applyEdits:function(i){var t=this.$refs.textarea,n=this.history.stack[this.history.offset];n&&t&&(this.history.stack[this.history.offset]=B({},n,{selectionStart:t.selectionStart,selectionEnd:t.selectionEnd})),this._recordChange(i),this._updateInput(i)},_recordChange:function(i,t){t===void 0&&(t=!1);var n=this.history,o=n.stack,s=n.offset;if(o.length&&s>-1){this.history.stack=o.slice(0,s+1);var f=this.history.stack.length;if(f>me){var a=f-me;this.history.stack=o.slice(a,f),this.history.offset=Math.max(this.history.offset-a,0)}}var u=Date.now();if(t){var c=this.history.stack[this.history.offset];if(c&&u-c.timestamp<Ne){var y,r,g=/[^a-z0-9]([a-z0-9]+)$/i,v=(y=this._getLines(c.value,c.selectionStart).pop())===null||y===void 0?void 0:y.match(g),d=(r=this._getLines(i.value,i.selectionStart).pop())===null||r===void 0?void 0:r.match(g);if(v&&d&&d[1].startsWith(v[1])){this.history.stack[this.history.offset]=B({},i,{timestamp:u});return}}}this.history.stack.push(B({},i,{timestamp:u})),this.history.offset++},_updateInput:function(i){var t=this.$refs.textarea;t&&(t.value=i.value,t.selectionStart=i.selectionStart,t.selectionEnd=i.selectionEnd,this.$emit("update:modelValue",i.value))},handleChange:function(i){var t=i.target,n=t.value,o=t.selectionStart,s=t.selectionEnd;this._recordChange({value:n,selectionStart:o,selectionEnd:s},!0),this.$emit("update:modelValue",n)},_undoEdit:function(){var i=this.history,t=i.stack,n=i.offset,o=t[n-1];o&&(this._updateInput(o),this.history.offset=Math.max(n-1,0))},_redoEdit:function(){var i=this.history,t=i.stack,n=i.offset,o=t[n+1];o&&(this._updateInput(o),this.history.offset=Math.min(n+1,t.length-1))},handleKeyDown:function(i){var t=this.tabSize,n=this.insertSpaces,o=this.ignoreTabKey;if(this.$emit("keydown",i),!i.defaultPrevented){i.keyCode===Je&&(i.target.blur(),this.$emit("blur",i));var s=i.target,f=s.value,a=s.selectionStart,u=s.selectionEnd,c=(n?" ":"	").repeat(t);if(i.keyCode===Ue&&!o&&this.capture)if(i.preventDefault(),i.shiftKey){var y=this._getLines(f,a),r=y.length-1,g=this._getLines(f,u).length-1,v=f.split(`
`).map(function(m,x){return x>=r&&x<=g&&m.startsWith(c)?m.substring(c.length):m}).join(`
`);if(f!==v){var d=y[r];this._applyEdits({value:v,selectionStart:d.startsWith(c)?a-c.length:a,selectionEnd:u-(f.length-v.length)})}}else if(a!==u){var O=this._getLines(f,a),j=O.length-1,p=this._getLines(f,u).length-1,$=O[j];this._applyEdits({value:f.split(`
`).map(function(m,x){return x>=j&&x<=p?c+m:m}).join(`
`),selectionStart:/\S/.test($)?a+c.length:a,selectionEnd:u+c.length*(p-j+1)})}else{var S=a+c.length;this._applyEdits({value:f.substring(0,a)+c+f.substring(u),selectionStart:S,selectionEnd:S})}else if(i.keyCode===Qe){var H=a!==u,P=f.substring(0,a);if(P.endsWith(c)&&!H){i.preventDefault();var _=a-c.length;this._applyEdits({value:f.substring(0,a-c.length)+f.substring(u),selectionStart:_,selectionEnd:_})}}else if(i.keyCode===We){if(a===u){var K=this._getLines(f,a).pop(),M=K==null?void 0:K.match(/^\s+/);if(M&&M[0]){i.preventDefault();var E=`
`+M[0],R=a+E.length;this._applyEdits({value:f.substring(0,a)+E+f.substring(u),selectionStart:R,selectionEnd:R})}}}else if(i.keyCode===ce||i.keyCode===de||i.keyCode===pe||i.keyCode===ye){var C;i.keyCode===ce&&i.shiftKey?C=["(",")"]:i.keyCode===de?i.shiftKey?C=["{","}"]:C=["[","]"]:i.keyCode===pe?i.shiftKey?C=['"','"']:C=["'","'"]:i.keyCode===ye&&!i.shiftKey&&(C=["`","`"]),a!==u&&C&&(i.preventDefault(),this._applyEdits({value:f.substring(0,a)+C[0]+f.substring(a,u)+C[1]+f.substring(u),selectionStart:a,selectionEnd:u+2}))}else(W?i.metaKey&&i.keyCode===G:i.ctrlKey&&i.keyCode===G)&&!i.shiftKey&&!i.altKey?(i.preventDefault(),this._undoEdit()):(W?i.metaKey&&i.keyCode===G&&i.shiftKey:Fe?i.ctrlKey&&i.keyCode===Ze:i.ctrlKey&&i.keyCode===G&&i.shiftKey)&&!i.altKey?(i.preventDefault(),this._redoEdit()):i.keyCode===Xe&&i.ctrlKey&&(!W||i.shiftKey)&&(i.preventDefault(),this.capture=!this.capture)}}},render:function(){var i=this,t=A("div",{class:"prism-editor__line-width-calc",style:"height: 0px; visibility: hidden; pointer-events: none;"},"999"),n=A("div",{class:"prism-editor__line-numbers",style:{"min-height":this.lineNumbersHeight},"aria-hidden":"true"},[t,Array.from(Array(this.lineNumbersCount).keys()).map(function(a,u){return A("div",{class:"prism-editor__line-number token comment"},""+ ++u)})]),o=A("textarea",{ref:"textarea",onInput:this.handleChange,onKeydown:this.handleKeyDown,onClick:function(u){i.$emit("click",u)},onKeyup:function(u){i.$emit("keyup",u)},onFocus:function(u){i.$emit("focus",u)},onBlur:function(u){i.$emit("blur",u)},class:{"prism-editor__textarea":!0,"prism-editor__textarea--empty":this.isEmpty},spellCheck:"false",autocapitalize:"off",autocomplete:"off",autocorrect:"off","data-gramm":"false",placeholder:this.placeholder,"data-testid":"textarea",readonly:this.readonly,value:this.codeData}),s=A("pre",{ref:"pre",class:"prism-editor__editor","data-testid":"preview",innerHTML:this.content}),f=A("div",{class:"prism-editor__container"},[o,s]);return A("div",{class:"prism-editor-wrapper"},[this.lineNumbers&&n,f])}});function he(e,i){var n,o;const t=[];if(i==="object")for(const s of Object.keys(e)){if(s==="properties")for(const f of Object.keys(e.properties??{}))t.push({key:f}),(n=e.dependencies)!=null&&n[f]&&!Array.isArray(e.dependencies[f])&&t.push({key:`$deps-${f}`}),e.dependentSchemas&&e.dependentSchemas[f]&&t.push({key:`$deps-${f}`});if(s==="patternProperties"&&t.push({key:"$patternProperties"}),s==="allOf"&&(o=e.allOf)!=null&&o.length)for(let f=0;f<e.allOf.length;f++)t.push({key:`$allOf-${f}`});s==="oneOf"&&t.push({key:"$oneOf"}),s==="then"&&e.if&&t.push({key:"$then"}),s==="else"&&e.if&&t.push({key:"$else"})}if(i==="array"&&Array.isArray(e.items))for(let s=0;s<e.items.length;s++)t.push({key:s});return t}function X(e,i){if(!i)return e;let t=0;return i.map(n=>{if(typeof n=="string"){const o=e.find(s=>s.key===n);if(!o)throw new Error(`unknown child "${n}"`);return o}else if(n.if&&(n.if=D(n.if)),typeof n.cols=="number"&&(n.cols={sm:n.cols}),typeof n.cols=="object"&&n.cols.xs===void 0&&(n.cols.xs=12),n.key){if(!e.find(s=>s.key===n.key))throw new Error(`unknown child "${n.key}"`);return n}else{const o=n;return xe(o)&&(o.comp||(o.comp="section"),o.children=X(e,o.children)),"key"in n||(o.key=`$comp-${t}`,t++),o}})}function et(e,i,t,n){const o=t&&["string","integer","number"].includes(t);if(n==="oneOf")return"one-of-select";if(n==="patternProperties")return"list";if(o&&i.enum)return i.enum.length>20?"autocomplete":"select";if(o&&i.oneOf)return i.oneOf.length>20?"autocomplete":"select";if(o&&i.examples||o&&i.anyOf&&i.anyOf.length&&Object.keys(i.anyOf[i.anyOf.length-1]).length===0)return t==="string"?"combobox":"number-combobox";if(t==="string"&&e.separator)return"combobox";if(e.items)return e.items.length>20?"autocomplete":"select";if(e.getItems)return Ee(e.getItems)&&(e.getItems.qSearchParam||typeof e.getItems.url=="string"&&e.getItems.url.includes("{q}")||typeof e.getItems.url=="object"&&typeof e.getItems.url.expr=="string"&&e.getItems.url.expr.includes("{q}"))?"autocomplete":"select";if(t==="array"&&i.items){const s=["string","integer","number"].includes(i.items.type);if(s&&(i.items.enum||i.items.oneOf))return(i.items.enum||i.items.oneOf).length>20?"autocomplete":"select";if(s&&i.items.examples||s&&i.items.anyOf&&i.items.anyOf.length&&Object.keys(i.items.anyOf[i.items.anyOf.length-1]).length===0||s&&!i.items.layout&&!["date","date-time","time"].includes(i.items.format))return i.items.type==="string"?"combobox":"number-combobox"}if(t==="object")return"section";if(t==="array")return Array.isArray(i.items)?"section":"list";if(t==="string")return i.format==="date"?"date-picker":i.format==="date-time"?"date-time-picker":i.format==="time"?"time-picker":"text-field";if(t==="integer"||t==="number")return"number-field";if(t==="boolean")return"checkbox";throw new Error("failed to calculate default component for schema fragment")}function tt(e){return Ae(e)?{...e}:Le(e)?{comp:e}:Te(e)?{children:e}:{}}function it(e){const i=typeof e=="string"?e:e.expr;return!i.includes("rootData.")&&!i.includes("rootData[")&&!i.includes("parent.data")&&!i.includes("parent.parent")}function D(e,i="js-eval",t="value"){const n=it(e);return typeof e=="string"?{type:i,expr:e,pure:n,dataAlias:t}:{pure:n,type:i,dataAlias:t,...e}}function ge(e){if(!e)return null;const{type:i}=T(e),t=i&&["string","integer","number"].includes(i);if(e.enum&&t)return e.enum.map(n=>({key:n+"",title:n+"",value:n}));if(e.examples&&t)return e.examples.map(n=>({key:n+"",title:n+"",value:n}));if(e.anyOf&&t&&e.anyOf.length&&Object.keys(e.anyOf[e.anyOf.length-1]).length===0){const n=e.anyOf.slice(0,-1);if(!n.find(o=>!("const"in o)))return n.map(o=>({...o,key:o.const+"",title:(o.title??o.const)+"",value:o.const}))}return e.oneOf&&t&&!e.oneOf.find(n=>!("const"in n))?e.oneOf.map(n=>({...n,key:n.const+"",title:(n.title??n.const)+"",value:n.const})):null}const T=e=>{if(Array.isArray(e.type)&&e.type.length===2&&e.type.includes("null"))return{type:e.type.find(t=>t!=="null"),nullable:!0};if(!e.type&&(e.properties||e.patternProperties))return{type:"object",nullable:!1};if(!e.type){const i=[];for(const t of["allOf","anyOf","oneOf"])if(e[t])for(const n of e[t]){const{type:o}=T(n);o&&!i.includes(o)&&i.push(o)}if(i.length===1)return{type:i[0],nullable:!1}}return{type:e.type,nullable:!1}};function be(e,i,t,n,o,s,f,a,u,c,y){if("const"in t)return{comp:"none"};if(!n)return{comp:"none"};const r=tt(i);if(n==="array"&&!t.items&&r.comp!=="file-input")return{comp:"none"};r.comp||(r.comp=et(r,t,n,y));const g=f[r.comp];if(!g)throw new Error(`unknown component "${r.comp}"`);if(r.comp==="none")return{comp:"none"};if(o&&(r.nullable=o),g.composite){const d=X(he(t,n),r.children);r.children=d,"title"in r||d.length===1&&d[0].key==="$patternProperties"||(r.title=t.title??null)}else if(r.comp==="list")if(y==="patternProperties"){if(!("title"in r)){const O=X(he(t,n),r.children);O.length===1&&O[0].key==="$patternProperties"&&(r.title=t.title??null)}let d=!1;for(const O of Object.values(t.patternProperties??{})){const{type:j}=T(O);j==="object"&&(d=!0)}r.listEditMode=r.listEditMode??(d?"inline-single":"inline"),r.listActions=r.listActions??["add","edit","delete"],r.indexed=Object.keys(t.patternProperties??{})}else{"title"in r||(r.title=t.title??""+e);const{type:d}=T(t.items);r.listEditMode=r.listEditMode??(d==="object"?"inline-single":"inline"),r.listActions=r.listActions??["add","edit","delete","duplicate","sort"]}else!("label"in r)&&!y&&(r.label=t.title??""+e);if(g.itemsBased&&!r.items){let d;n==="array"?d=ge(t.items):d=ge(t),d&&(r.getItems&&ue(r.getItems)?(r.getItems.expr=JSON.stringify(d),r.getItems.immutable=!0):r.getItems={expr:JSON.stringify(d),immutable:!0})}g.multipleCompat&&(n==="array"||r.separator)&&(r.multiple=!0),r.comp==="date-picker"&&(t.format==="date"&&(r.format="date"),t.format==="date-time"&&(r.format="date-time")),["date-picker","date-time-picker","time-picker"].includes(r.comp)&&("formatMinimum"in t&&(r.min=r.min??t.formatMinimum),"formatMaximum"in t&&(r.max=r.max??t.formatMaximum)),["number-field","slider"].includes(r.comp)&&(n==="integer"&&(r.step=r.step??1),"minimum"in t&&(r.min=r.min??t.minimum),"maximum"in t&&(r.max=r.max??t.maximum)),r.if&&(r.if=D(r.if)),!r.defaultData&&t.type==="string"&&s.split("#").pop()===""&&(r.defaultData="");for(const d of c)d in r&&(r.options=r.options??{},r.options[d]=r[d],delete r[d]);if(t.readOnly&&(r.options=r.options??{},"readOnly"in r.options||(r.options.readOnly=!0)),r.getOptions!==void 0&&(r.getOptions=D(r.getOptions)),r.getDefaultData!==void 0&&(r.getDefaultData=D(r.getDefaultData)),r.getConstData!==void 0&&(r.getConstData=D(r.getConstData)),r.transformData!==void 0&&(r.transformData=D(r.transformData)),r.getProps!==void 0&&(r.getProps=D(r.getProps)),r.getItems&&_e(r.getItems)&&(r.getItems=D(r.getItems)),r.getItems&&ue(r.getItems)){if(n==="object"&&(r.getItems.returnObjects=!0),n==="array"){const{type:d}=T(t.items);d==="object"&&(r.getItems.returnObjects=!0)}r.getItems.itemTitle&&(r.getItems.itemTitle=D(r.getItems.itemTitle,"js-eval","item")),r.getItems.itemKey&&(r.getItems.itemKey=D(r.getItems.itemKey,"js-eval","item")),r.getItems.itemValue&&(r.getItems.itemValue=D(r.getItems.itemValue,"js-eval","item")),r.getItems.itemIcon&&(r.getItems.itemIcon=D(r.getItems.itemIcon,"js-eval","item")),r.getItems.itemsResults&&(r.getItems.itemsResults=D(r.getItems.itemsResults,"js-eval","body"))}if(r.getItems&&Ee(r.getItems)&&(r.getItems.url=D(r.getItems.url,"js-tpl")),r.items&&(r.items=r.items.map(d=>{if(["string","integer","number"].includes(typeof d))return{title:d+"",key:d+"",value:d};if(typeof d=="object")return{key:(d.key??d.value)+"",title:(d.title??d.key??d.value)+"",value:d.value??d.key};throw new Error(`bad item for select: ${JSON.stringify(d)}`)})),!r.comp&&(r.items??r.getItems)&&(r.comp="select"),r.comp==="date-picker"&&t.format==="date-time"&&(r.format="date-time"),r.slots)for(const[d,O]of Object.entries(r.slots)){typeof O=="string"&&(["before","after"].includes(d)?r.slots[d]={markdown:O}:r.slots[d]={name:O});const j=r.slots[d];Se(j)&&(j.markdown=a(j.markdown).trim())}t.description&&(g.composite&&r.title&&u.includes("subtitle")?r.subtitle===void 0&&(r.subtitle=t.description):!g.composite&&u.includes("hint")?r.hint===void 0&&(r.hint=t.description):y!=="oneOf"&&u.includes("help")&&r.help===void 0&&(r.help=t.description)),r.help&&(r.help=a(r.help).trim()),r.subtitle&&(r.subtitle=a(r.subtitle).trim()),typeof r.cols=="number"&&(r.cols={xs:r.cols}),typeof r.cols=="object"&&r.cols.xs===void 0&&(r.cols.xs=12);const v=Ke(g);if(!v(r)){const d=new Error(`component "${g.name}" validation errors`);throw d.cause=J(v.errors),d}return r}function nt(e,i,t,n,o,s,f,a,u,c,y){if(Ce(i)){const r=[],g=[...i.switch];g.find(v=>!v.if)||g.push({});for(let v=0;v<g.length;v++){const d=g[v],O=be(e,d,t,n,o,s,f,a,u,c,y);r.push(O)}return{switch:r}}else return be(e,i,t,n,o,s,f,a,u,c,y)}function U(e,i){return e.keyword==="errorMessage"&&(e=e.params.errors[0]),i(e)}function J(e){if(!e)return[];const i=e.filter(n=>U(n,o=>o.keyword==="anyOf"||o.keyword==="oneOf"));for(const n of i)e.find(s=>U(s,f=>f.instancePath===n.instancePath&&f.keyword!=="type"))&&(e=e.filter(s=>U(s,f=>f.instancePath!==n.instancePath||f.keyword!=="type")));const t=[];for(const n of e){let o=n.instancePath+" "+(n.message??n.keyword);n.params&&(o+=" "+JSON.stringify(n.params)),t.push(o)}return t}const ve=["readOnly","summary","titleDepth","density","removeAdditional","validateOn","updateOne","debounceInputMs","initialValidation","defaultOn","readOnlyPropertiesMode"];function Oe(e,i,t,n,o,s,f,a,u,c){u=u?u.concat(ve):ve;let y;if(c==="oneOf"?y=i.oneOfLayout??{}:c==="patternProperties"?y=i.patternPropertiesLayout??{}:y=i.layout??{},!le(y)){const g=new Error("layout keyword validation errors at path");throw g.cause=J(le.errors),g}const r=nt(e,y,i,t,n,o,s,f,a,u,c);if(!fe(r)){const g=new Error("normalized layout validation errors at path");throw g.cause=J(fe.errors),g}return r}function Q(e,i,t,n,o=y=>y,s,f,a,u,c){const{type:y,nullable:r}=u?{type:u,nullable:c??!1}:T(i),g=[];try{return{layout:Oe(e,i,y,r,t,n,o,s,f,a),errors:g}}catch(v){try{return g.push(v.message),v.cause&&Array.isArray(v.cause)&&g.push(...v.cause),g.push("failed to normalize layout, use default component"),{layout:Oe(e,{...i,layout:{}},y,r,t,n,o,s,f,a),errors:g}}catch(d){return g.push(d.message),d.cause&&Array.isArray(d.cause)&&g.push(...d.cause),g.push("failed to produce default layout, hide this fragment"),{layout:{comp:"none"},errors:g}}}}function je(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function rt(){return i;function e(t,n){const o=Object.keys(t),s=new Array(o.length);for(let f=0;f<o.length;f++){const a=o[f],u=t[a];typeof u!="object"||u===null?s[a]=u:u instanceof Date?s[a]=new Date(u):ArrayBuffer.isView(u)?s[a]=je(u):s[a]=n(u)}return s}function i(t){if(typeof t!="object"||t===null)return t;if(t instanceof Date)return new Date(t);if(Array.isArray(t))return e(t,i);if(t instanceof Map)return new Map(e(Array.from(t),i));if(t instanceof Set)return new Set(e(Array.from(t),i));const n={};for(const o in t){if(Object.hasOwnProperty.call(t,o)===!1)continue;const s=t[o];typeof s!="object"||s===null?n[o]=s:s instanceof Date?n[o]=new Date(s):s instanceof Map?n[o]=new Map(e(Array.from(s),i)):s instanceof Set?n[o]=new Set(e(Array.from(s),i)):ArrayBuffer.isView(s)?n[o]=je(s):n[o]=i(s)}return n}}const q=rt(),ot=(e,i)=>(t,n)=>{var c;const o=i.opts.uriResolver.resolve(t,n),[s,f]=o.split("#");if(e[s]=e[s]??((c=i.getSchema(s))==null?void 0:c.schema),!e[s])throw new Error(`reference not found ${s}`);if(!f)return[e[s],s,o];const a=f.split("/").filter(y=>!!y),{value:u}=a.reduce((y,r)=>{if(y.path.push(r),!(r in y.value))throw new Error(`reference not found ${s}#${y.path.join("/")}`);return y.value=y.value[r],y},{path:[],value:e[s]});return[u,s,o]};function st(e,i,t="en",n="en"){if(!e.$id)throw new Error("missing schema id");const o=ot({[e.$id]:e},i),s=[];return N(e,e.$id,o,t,n,s),o}const N=(e,i,t,n,o,s)=>{if(!s.includes(e)){s.push(e);for(const f of Object.keys(e))if(e[f]&&typeof e[f]=="object")if("$ref"in e[f]){const a=e[f].$ref.replace("~$locale~",n),u=e[f].$ref.replace("~$locale~",o);let c,y;try{[c,y]=t(i,a),e[f].$ref=a}catch{[c,y]=t(i,u),e[f].$ref=u}typeof c=="string"?e[f]=c:N(c,y,t,n,o,s)}else N(e[f],i,t,n,o,s)}};function lt(e,i,t){let n=null;if(e.items&&e.items.$ref){const[o]=t(i,e.items.$ref);n=n??q(e),n.items={...o,...e.items}}if(e.properties){for(const o in e.properties)if(e.properties[o].$ref){const[s]=t(i,e.properties[o].$ref);n=n??q(e),n.properties[o]={...s,...e.properties[o]}}}if(e.oneOf){for(let o=0;o<e.oneOf.length;o++)if(e.oneOf[o].$ref){const[s]=t(i,e.oneOf[o].$ref);n=n??q(e),n.oneOf[o]={...s,...e.oneOf[o]}}}if(e.anyOf){for(let o=0;o<e.anyOf.length;o++)if(e.anyOf[o].$ref){const[s]=t(i,e.anyOf[o].$ref);n=n??q(e),n.anyOf[o]={...s,...e.anyOf[o]}}}if(e.allOf){for(let o=0;o<e.allOf.length;o++)if(e.allOf[o].$ref){const[s]=t(i,e.allOf[o].$ref);n=n??q(e),n.allOf[o]={...s,...e.allOf[o]}}}return n??e}function L(e,i,t,n,o,s,f,a,u,c,y,r,g,v,d,O){var x,ee,te,ie,ne,re,oe,se;let j=i,p=e,$=r,S;e.__pointer=r,p.$ref&&([S,j,$]=n(i,p.$ref),S.__pointer=$,p={...e,...S},delete p.$ref);const H=lt(p,j,n);let{type:P,nullable:_}=T(H);if(O&&(P=O),e.errorMessage=e.errorMessage??{},!u[r]){const l=Q(y,H,r,t.components,t.markdown,t.useDescription,t.optionsKeys,void 0,P,_);u[r]=l.layout,l.errors.length&&(a[r.replace("_jl#","/")]=l.errors)}const K=u[r];let M=!d;const E=(l,b)=>{b.pure||(M=!1);const h=l.findIndex(k=>k.type===b.type&&k.expr===b.expr);h!==-1?b.ref=h:(b.ref=l.length,l.push(b))},R=l=>{if(l.if&&E(c,l.if),Be(l))for(const b of l.children)R(b)},C=Y(K)?K.switch:[K];for(const l of C){if(l.if&&E(c,l.if),ae(l,t.components))for(const h of l.children)R(h);p.const!==void 0&&l.constData===void 0&&(l.constData=p.const),l.constData!==void 0&&!l.getConstData&&(l.getConstData={type:"js-eval",expr:"layout.constData",pure:!0,dataAlias:"value"}),l.getConstData&&E(c,l.getConstData);let b;"default"in p?b=p.default:g&&(_?b=null:P==="object"&&ae(l,t.components)?b={}:P==="array"&&(b=[])),b!==void 0&&l.defaultData===void 0&&(l.defaultData=b),l.defaultData!==void 0&&!l.getDefaultData&&(l.getDefaultData={type:"js-eval",expr:"layout.defaultData",pure:!0,dataAlias:"value"}),l.getDefaultData&&E(c,l.getDefaultData),l.options!==void 0&&!l.getOptions&&(l.getOptions={type:"js-eval",expr:"layout.options",pure:!0,dataAlias:"value"}),l.getOptions&&E(c,l.getOptions),l.props!==void 0&&!l.getProps&&(l.getProps={type:"js-eval",expr:"layout.props",pure:!0,dataAlias:"value"}),l.getProps&&E(c,l.getProps),l.transformData&&E(c,l.transformData),Me(l,t.components)&&l.getItems&&(qe(l.getItems)&&E(c,l.getItems),Re(l.getItems)&&E(c,l.getItems.url),l.getItems.itemTitle&&E(c,l.getItems.itemTitle),l.getItems.itemKey&&E(c,l.getItems.itemKey),l.getItems.itemValue&&E(c,l.getItems.itemValue),l.getItems.itemIcon&&E(c,l.getItems.itemIcon),l.getItems.itemsResults&&E(c,l.getItems.itemsResults))}const m={key:y??"",pointer:r,refPointer:$,pure:M,propertyKeys:[],roPropertyKeys:[],nullable:_,required:g&&!_};if(v){if(Y(K))throw new Error("Switch struct not allowed in conditional schema");m.condition={type:"js-eval",expr:v,pure:!0,dataAlias:"value"},E(c,m.condition)}if(p.oneOf&&(e.errorMessage.oneOf=t.messages.errorOneOf),P==="object"){if(p.properties){m.children=m.children??[];for(const l of Object.keys(p.properties)){m.propertyKeys.push(l),p.properties[l].readOnly&&m.roPropertyKeys.push(l);const b=p.dependentRequired&&Object.values(p.dependentRequired).some(k=>k.includes(l)),h=`${$}/properties/${l}`;if(s[h]||(s[h]="recursing",s[h]=L(p.properties[l],j,t,n,o,s,f,a,u,c,l,h,(x=p.required)==null?void 0:x.includes(l),void 0,b)),m.children.push(h),(ee=p.dependentSchemas)!=null&&ee[l]||(te=p.dependencies)!=null&&te[l]&&!Array.isArray(p.dependencies[l])){const k=((ie=p.dependentSchemas)==null?void 0:ie[l])??p.dependencies[l],I=(ne=p.dependentSchemas)!=null&&ne[l]?`${$}/dependentSchemas/${l}`:`${$}/dependencies/${l}`;s[I]||(s[I]="recursing",s[I]=L(k,j,t,n,o,s,f,a,u,c,`$deps-${l}`,I,!1,`data["${l}"] !== undefined`,void 0,"object")),m.children.push(I)}}}if(p.allOf)for(let l=0;l<p.allOf.length;l++){const b=`${$}/allOf/${l}`;s[b]||(s[b]="recursing",s[b]=L(p.allOf[l],j,t,n,o,s,f,a,u,c,`$allOf-${l}`,b,!1,void 0,void 0,"object")),m.propertyKeys=m.propertyKeys.concat(s[b].propertyKeys),m.roPropertyKeys=m.roPropertyKeys.concat(s[b].roPropertyKeys),m.children=m.children??[],m.children.push(b)}if(p.oneOf){const l=`${r}/oneOf`;if(!u[l]){const h=Q("",p,l,t.components,t.markdown,t.useDescription,t.optionsKeys,"oneOf",P,_);u[l]=h.layout,h.errors.length&&(a[l.replace("_jl#","/")]=h.errors)}const b=[];for(let h=0;h<p.oneOf.length;h++){p.oneOf[h].type||(p.oneOf[h].type=P);const k=p.oneOf[h].title??`option ${h}`;delete p.oneOf[h].title;const I=`${l}/${h}`;o[I]||(o[I]="recursing",o[I]=z(p.oneOf[h],j,t,n,o,s,f,a,u,c,I,k)),b.push(I)}s[l]||(s[l]={key:"$oneOf",pointer:l,refPointer:l,childrenTrees:b,pure:!b.some(h=>{var k;return!s[(k=o[h])==null?void 0:k.root].pure}),propertyKeys:[],roPropertyKeys:[]}),m.children=m.children??[],m.children.push(l)}if(p.patternProperties){const l=`${r}/patternProperties`;if(!u[l]){const h=Q("",p,l,t.components,t.markdown,t.useDescription,t.optionsKeys,"patternProperties",P,_);u[l]=h.layout,h.errors.length&&(a[l.replace("_jl#","/")]=h.errors)}const b=[];for(const h of Object.keys(p.patternProperties)){const k=`${l}/${h}`;if(!o[k]){o[k]="recursing",o[k]=z(p.patternProperties[h],j,t,n,o,s,f,a,u,c,k,"pattern "+h);const I=u[s[o[k].root].pointer];if(Y(I))for(const Ie of I.switch)Ie.nullable=!0;else I.nullable=!0}b.push(k)}s[l]||(s[l]={key:"$patternProperties",pointer:l,refPointer:l,childrenTrees:b,pure:!b.some(h=>{var k;return!s[(k=o[h])==null?void 0:k.root].pure}),propertyKeys:[],roPropertyKeys:[]}),m.children=m.children??[],m.children.push(l)}if(p.if){if(f.push(`${r}/if`),p.then){const l=`${$}/then`;s[l]||(s[l]="recursing",s[l]=L(p.then,j,t,n,o,s,f,a,u,c,"$then",l,!1,`validates["${r}/if"](data)`,void 0,"object")),m.children=m.children??[],m.children.push(l)}if(p.else){const l=`${$}/else`;s[l]||(s[l]="recursing",s[l]=L(p.else,j,t,n,o,s,f,a,u,c,"$else",l,!1,`!validates["${r}/if"](data)`,void 0,"object")),m.children=m.children??[],m.children.push(l)}}for(const l of m.propertyKeys)(re=p==null?void 0:p.required)!=null&&re.includes(l)&&(e.errorMessage.required=e.errorMessage.required??{},e.errorMessage.required[l]=t.messages.errorRequired),p.dependentRequired&&Object.keys(p.dependentRequired).includes(l)&&(e.errorMessage.dependentRequired=t.messages.errorRequired)}if(P==="array"&&p.items)if(Array.isArray(p.items)){m.children=m.children??[];for(let l=0;l<p.items.length;l++){const b=p.items[l],h=`${$}/items/${l}`;s[h]||(s[h]="recursing",s[h]=L(b,j,t,n,o,s,f,a,u,c,l,h,!0)),m.children.push(h)}}else{const l=`${r}/items`;o[l]||(o[l]="recursing",o[l]=z(p.items,j,t,n,o,s,f,a,u,c,l,p.items.title)),m.childrenTrees=[l];const b=u[s[o[l].root].pointer];if(Y(b))for(const h of b.switch)h.nullable=!0;else b.nullable=!0}for(const l of m.children||[])s[l].pure||(m.pure=!1);for(const l of m.childrenTrees||[])(se=s[(oe=o[l])==null?void 0:oe.root])!=null&&se.pure||(m.pure=!1);return m}function z(e,i,t,n,o,s,f,a,u,c,y,r){return s[y]||(s[y]="recursing",s[y]=L(e,i,t,n,o,s,f,a,u,c,"",y,!0),f.push(s[y].refPointer)),{title:r,root:y,refPointer:s[y].refPointer}}const F=(e,i,t="en")=>{for(const[n,o]of Object.entries(e)){if(n.startsWith("x-i18n-")){typeof o!="object"&&console.error(`i18n property ${n} should be an object`);const s=n.replace("x-i18n-","");e[s]=o[i]??o[t]??e[s],delete e[n]}else if(Array.isArray(o))for(const s of o)F(s,i,t);typeof o=="object"&&F(o,i,t)}},ft={errorOneOf:"choisissez une valeur",errorRequired:"information obligatoire",addItem:"Ajouter un élément",delete:"Supprimer",edit:"Éditer",close:"Fermer",duplicate:"Dupliquer",sort:"Trier",up:"Décaler vers le haut",down:"Décaler vers le bas",showHelp:"Afficher un message d'aide",mdeLink1:"[titre du lien",mdeLink2:"](adresse du lien)",mdeImg1:"![](",mdeImg2:"adresse de l'image)",mdeTable1:"",mdeTable2:`

| Colonne 1 | Colonne 2 | Colonne 3 |
| -------- | -------- | -------- |
| Texte     | Texte     | Texte     |

`,bold:"Gras",italic:"Italique",heading:"Titre",quote:"Citation",unorderedList:"Liste à puce",orderedList:"Liste numérotée",createLink:"Créer un lien",insertImage:"Insérer une image",createTable:"Créer un tableau",preview:"Preview",mdeGuide:"Syntax documentation",undo:"Défaire",redo:"Refaire"},ut={errorOneOf:"Kies er een",errorRequired:"benodigde informatie",addItem:"Item toevoegen",delete:"Verwijderen",edit:"Bewerken",close:"Sluiten",duplicate:"Verveelvoudigen",sort:"Sorteren",up:"Omhoog verplaatsen",down:"Omlaag verplaatsen",showHelp:"Toon helpbericht",mdeLink1:"[Link titel",mdeLink2:"](link url)",mdeImg1:"![](",mdeImg2:"afbeelding url)",mdeTable1:"",mdeTable2:`

| Kolom 1  | Kolom 2  | Kolom 3  |
| -------- | -------- | -------- |
| Tekst    | Tekst    | Tekst    |

`,bold:"Vet",italic:"Cursief",heading:"Titel",quote:"Citaat",unorderedList:"Ongeordende lijst",orderedList:"Geordende lijst",createLink:"Maak een koppeling",insertImage:"Afbeelding invoegen",createTable:"Tabel aanmaken",preview:"Voorbeeld",mdeGuide:"Documentatie over syntaxis",undo:"Ongedaan maken",redo:"Opnieuw"},at={errorOneOf:"Wählen Sie eine Option",errorRequired:"Erforderliche Information",addItem:"Element hinzufügen",delete:"Löschen",edit:"Bearbeiten",close:"Schließen",duplicate:"Duplizieren",sort:"Sortieren",up:"Nach oben verschieben",down:"Nach unten verschieben",showHelp:"Hilfemeldung anzeigen",mdeLink1:"[Link-Titel",mdeLink2:"](Link-URL)",mdeImg1:"![](",mdeImg2:"Bild-URL)",mdeTable1:"",mdeTable2:`

| Spalte 1 | Spalte 2 | Spalte 3 |
| -------- | -------- | -------- |
| Text     | Text     | Text     |

`,bold:"Fett",italic:"Kursiv",heading:"Titel",quote:"Zitat",unorderedList:"Ungeordnete Liste",orderedList:"Geordnete Liste",createLink:"Link erstellen",insertImage:"Bild einfügen",createTable:"Tabelle erstellen",preview:"Vorschau",mdeGuide:"Syntax-Dokumentation",undo:"Rückgängig",redo:"Wiederholen"},ke={en:ze,fr:ft,nl:ut,de:at};function ct(e=[],i=[]){if(!e||!i)return e===i;if(e.length!==i.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==i[t])return!1;return!0}const dt=Ge,pt=e=>{let i=e.ajv;if(!i){const a={allErrors:!0,strict:!1,verbose:!0};e.ajvOptions&&Object.assign(a,e.ajvOptions),e.code&&(a.code={source:!0,esm:!0,lines:!0});const u=new dt(a);He.default(u),Ye.default(u),i=u}i.addKeyword("layout");let t=e.markdown;t||(t=u=>we.parse(u,e.markedOptions));const n=e.defaultLocale||"en",o=e.locale||n,s={...ke[o]||ke[n]};e.messages&&Object.assign(s,e.messages);const f=Ve.reduce((a,u)=>(a[u.name]=u,a),{});if(e.components){for(const a of Object.keys(e.components))f[a]={...e.components[a],name:a};Object.assign(f,e.components)}return{ajv:i,code:!1,markdown:t,optionsKeys:[],useDescription:["help","subtitle"],...e,locale:o,defaultLocale:n,messages:s,components:f,xI18n:!!e.xI18n}};w((e,i)=>{for(const t of["ajv","ajvOptions","code","markdown","markedOptions","xI18n","locale","defaultLocale","messages","optionsKeys","components","useDescription"])if(t in i){if(t==="components"&&ct(Object.keys(e.components??[]),Object.keys(i.components??[])))continue;e[t]=i[t]}else delete e[t]});const $e=Pe;function Et(e,i={}){const t=pt(i),n=q(e);n.$id=n.$id??"_jl";const o=st(n,t.ajv,t.locale,t.defaultLocale);t.xI18n&&F(n,t.locale,t.defaultLocale);const s=[],f={},a=[],u={},c={},y={},r=`${n.$id}#`;c[r]="recursing",c[r]=z(n,n.$id,t,o,c,y,s,u,f,a,r,"main"),t.ajv.addSchema(n);const g=t.ajv.opts.uriResolver,v={};for(const O of s){const j=g.resolve(n.$id,O);v[O]=t.ajv.compile({$ref:j})}const d=[];for(const O of a){const j=O.pure?["data",O.dataAlias,"options","context","display","layout","readOnly","summary","validates"]:["data",O.dataAlias,"options","context","display","layout","readOnly","summary","validates","rootData","parent"];O.type==="js-fn"&&d.push(new Function(...j,O.expr)),O.type==="js-eval"&&d.push(new Function(...j,"return ("+O.expr+")")),O.type==="js-tpl"&&d.push(new Function(...j,"return `"+O.expr+"`"))}return Object.keys(u).length&&console.error("JSON layout encountered some validation errors:",u),{options:t,schema:n,mainTree:r,skeletonTrees:c,skeletonNodes:y,validates:v,validationErrors:u,normalizedLayouts:f,expressions:d,locale:t.locale,messages:t.messages,components:t.components,localizeErrors:$e[t.locale]||$e.en}}const Z={};function yt(e){return Z[e]=Z[e]??new RegExp(e),Z[e]}V("jl:state-node");V("jl:validation");w((e,i,t,n,o,s,f,a,u,c,y,r,g,v,d,O,j,p)=>{if(e.messages=a.messages?mt(e.messages||{},a.messages,v):v.messages,e.key=i,e.fullKey=t,e.parentFullKey=n,e.dataPath=o,e.parentDataPath=s,e.skeleton=f,e.layout=a,e.width=u,e.options=v,e.cols=c,e.data=y,e.error=r,e.itemsCacheKey=j,e.childError=p&&p.findIndex($=>$.error||$.childError)!==-1,e.validated=g,d)e.autofocus=!0,delete e.autofocusChild;else{delete e.autofocus;const $=p==null?void 0:p.find(S=>S.autofocus);$?e.autofocusChild=$.key:delete e.autofocusChild}e.props=O,e.children=p});const mt=w((e,i,t)=>{Object.assign(e,t.messages,i)});w((e,i)=>{for(const t of i){const n=t.key;t.data===void 0?delete e[n]:e[n]=t.data}for(;e.length&&e[e.length-1]===void 0;)e.pop()});w((e,i,t,n,o)=>{for(let s=0;s<e.length;s++)e[s]instanceof File||(e[s]=ht(e[s],i+"/"+s,void 0,t,n,o))});const ht=w((e,i,t,n,o,s)=>{if(o&&(o.length||t!=null&&t.length))for(const f of Object.keys(e))o.includes(f)||delete e[f];if(s)for(const f of s)delete e[f];if(t)for(const f of t)if(i===f.dataPath){if(f.data===void 0)continue;Object.assign(e,f.data)}else f.data===void 0?delete e[f.key]:e[f.key]=f.data;if(n)for(const f of n)f.instancePath===i&&(f.keyword==="additionalProperties"&&delete e[f.params.additionalProperty],f.keyword==="unevaluatedProperties"&&delete e[f.params.unevaluatedProperty])});w((e,i,t,n)=>{for(const o of Object.keys(i))t.includes(o)||n.some(s=>!!o.match(yt(s)))&&(e[o]=i[o]);for(const o of Object.keys(e))o in i||delete e[o]});w((e,i,t={})=>{for(const n in i)e[n]=t[n]??i[n];for(const n in t)e[n]=t[n];for(const n in e)!(n in i)&&!(n in t)&&delete e[n]});w(e=>{e.readOnly=!0,e.summary=!0});w((e,i)=>{i.title&&e.titleDepth<6&&(e.titleDepth+=1)});w((e,i,t)=>{if(i.dataPath===i.parentDataPath){if(Object.assign(e,t),i.data&&typeof t=="object"&&t!==null)for(const n of Object.keys(i.data))n in t||delete e[n]}else e[i.key]=t});V("jl:validation");w((e,i,t)=>{e.root=i,e.valid=t});V("jl:data-binding");V("jl:select-items");export{$t as P,Et as c};
