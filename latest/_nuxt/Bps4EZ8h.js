import{d as Se,h as C,aO as _e}from"./D0jcXilj.js";import{d as Ke}from"./BJ_tNUss.js";import{v as ue,a as ae,i as xe,b as ce,c as Ae,d as we,g as Ce,e as de,f as Le,h as Te,j as Me,k as qe,l as Re,m as Be,o as Ve,p as Y,q as pe,r as He,t as Ye,u as ze,w as Ge,s as We}from"./CHN0og0l.js";import{a as Ue,c as Qe,d as Ze}from"./C4ZUjfEK.js";import{p as P,b as B}from"./B8bVWMNf.js";import{e as Xe}from"./kY6r_Lxp.js";function H(){return H=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},H.apply(this,arguments)}var Je=13,Ne=9,Fe=8,et=89,z=90,tt=77,ye=57,me=219,he=222,ge=192,it=27,be=100,nt=3e3,rt=typeof window<"u"&&navigator&&/Win/i.test(navigator.platform),U=typeof window<"u"&&navigator&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),Pt=Se({props:{lineNumbers:{type:Boolean,default:!1},autoStyleLineNumbers:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},modelValue:{type:String,default:""},highlight:{type:Function,required:!0},tabSize:{type:Number,default:2},insertSpaces:{type:Boolean,default:!0},ignoreTabKey:{type:Boolean,default:!1},placeholder:{type:String,default:""}},data:function(){return{capture:!0,history:{stack:[],offset:-1},lineNumbersHeight:"20px",codeData:""}},watch:{modelValue:{immediate:!0,handler:function(i){i?this.codeData=i:this.codeData=""}},content:{immediate:!0,handler:function(){var i=this;this.lineNumbers&&this.$nextTick(function(){i.setLineNumbersHeight()})}},lineNumbers:function(){var i=this;this.$nextTick(function(){i.styleLineNumbers(),i.setLineNumbersHeight()})}},computed:{isEmpty:function(){return this.codeData.length===0},content:function(){var i=this.highlight(this.codeData)+"<br />";return i},lineNumbersCount:function(){var i=this.codeData.split(/\r\n|\n/).length;return i}},mounted:function(){this._recordCurrentState(),this.styleLineNumbers()},methods:{setLineNumbersHeight:function(){this.lineNumbersHeight=getComputedStyle(this.$refs.pre).height},styleLineNumbers:function(){if(!(!this.lineNumbers||!this.autoStyleLineNumbers)){var i=this.$refs.pre,t=this.$el.querySelector(".prism-editor__line-numbers"),n=window.getComputedStyle(i);this.$nextTick(function(){var s="border-top-left-radius",r="border-bottom-left-radius";if(t){t.style[s]=n[s],t.style[r]=n[r],i.style[s]="0",i.style[r]="0";var f=["background-color","margin-top","padding-top","font-family","font-size","line-height"];f.forEach(function(u){t.style[u]=n[u]}),t.style["margin-bottom"]="-"+n["padding-top"]}})}},_recordCurrentState:function(){var i=this.$refs.textarea;if(i){var t=i.value,n=i.selectionStart,s=i.selectionEnd;this._recordChange({value:t,selectionStart:n,selectionEnd:s})}},_getLines:function(i,t){return i.substring(0,t).split(`
`)},_applyEdits:function(i){var t=this.$refs.textarea,n=this.history.stack[this.history.offset];n&&t&&(this.history.stack[this.history.offset]=H({},n,{selectionStart:t.selectionStart,selectionEnd:t.selectionEnd})),this._recordChange(i),this._updateInput(i)},_recordChange:function(i,t){t===void 0&&(t=!1);var n=this.history,s=n.stack,r=n.offset;if(s.length&&r>-1){this.history.stack=s.slice(0,r+1);var f=this.history.stack.length;if(f>be){var u=f-be;this.history.stack=s.slice(u,f),this.history.offset=Math.max(this.history.offset-u,0)}}var a=Date.now();if(t){var c=this.history.stack[this.history.offset];if(c&&a-c.timestamp<nt){var y,o,g=/[^a-z0-9]([a-z0-9]+)$/i,v=(y=this._getLines(c.value,c.selectionStart).pop())===null||y===void 0?void 0:y.match(g),d=(o=this._getLines(i.value,i.selectionStart).pop())===null||o===void 0?void 0:o.match(g);if(v&&d&&d[1].startsWith(v[1])){this.history.stack[this.history.offset]=H({},i,{timestamp:a});return}}}this.history.stack.push(H({},i,{timestamp:a})),this.history.offset++},_updateInput:function(i){var t=this.$refs.textarea;t&&(t.value=i.value,t.selectionStart=i.selectionStart,t.selectionEnd=i.selectionEnd,this.$emit("update:modelValue",i.value))},handleChange:function(i){var t=i.target,n=t.value,s=t.selectionStart,r=t.selectionEnd;this._recordChange({value:n,selectionStart:s,selectionEnd:r},!0),this.$emit("update:modelValue",n)},_undoEdit:function(){var i=this.history,t=i.stack,n=i.offset,s=t[n-1];s&&(this._updateInput(s),this.history.offset=Math.max(n-1,0))},_redoEdit:function(){var i=this.history,t=i.stack,n=i.offset,s=t[n+1];s&&(this._updateInput(s),this.history.offset=Math.min(n+1,t.length-1))},handleKeyDown:function(i){var t=this.tabSize,n=this.insertSpaces,s=this.ignoreTabKey;if(this.$emit("keydown",i),!i.defaultPrevented){i.keyCode===it&&(i.target.blur(),this.$emit("blur",i));var r=i.target,f=r.value,u=r.selectionStart,a=r.selectionEnd,c=(n?" ":"	").repeat(t);if(i.keyCode===Ne&&!s&&this.capture)if(i.preventDefault(),i.shiftKey){var y=this._getLines(f,u),o=y.length-1,g=this._getLines(f,a).length-1,v=f.split(`
`).map(function(m,A){return A>=o&&A<=g&&m.startsWith(c)?m.substring(c.length):m}).join(`
`);if(f!==v){var d=y[o];this._applyEdits({value:v,selectionStart:d.startsWith(c)?u-c.length:u,selectionEnd:a-(f.length-v.length)})}}else if(u!==a){var O=this._getLines(f,u),j=O.length-1,p=this._getLines(f,a).length-1,k=O[j];this._applyEdits({value:f.split(`
`).map(function(m,A){return A>=j&&A<=p?c+m:m}).join(`
`),selectionStart:/\S/.test(k)?u+c.length:u,selectionEnd:a+c.length*(p-j+1)})}else{var w=u+c.length;this._applyEdits({value:f.substring(0,u)+c+f.substring(a),selectionStart:w,selectionEnd:w})}else if(i.keyCode===Fe){var M=u!==a,S=f.substring(0,u);if(S.endsWith(c)&&!M){i.preventDefault();var K=u-c.length;this._applyEdits({value:f.substring(0,u-c.length)+f.substring(a),selectionStart:K,selectionEnd:K})}}else if(i.keyCode===Je){if(u===a){var x=this._getLines(f,u).pop(),q=x==null?void 0:x.match(/^\s+/);if(q&&q[0]){i.preventDefault();var I=`
`+q[0],V=u+I.length;this._applyEdits({value:f.substring(0,u)+I+f.substring(a),selectionStart:V,selectionEnd:V})}}}else if(i.keyCode===ye||i.keyCode===me||i.keyCode===he||i.keyCode===ge){var _;i.keyCode===ye&&i.shiftKey?_=["(",")"]:i.keyCode===me?i.shiftKey?_=["{","}"]:_=["[","]"]:i.keyCode===he?i.shiftKey?_=['"','"']:_=["'","'"]:i.keyCode===ge&&!i.shiftKey&&(_=["`","`"]),u!==a&&_&&(i.preventDefault(),this._applyEdits({value:f.substring(0,u)+_[0]+f.substring(u,a)+_[1]+f.substring(a),selectionStart:u,selectionEnd:a+2}))}else(U?i.metaKey&&i.keyCode===z:i.ctrlKey&&i.keyCode===z)&&!i.shiftKey&&!i.altKey?(i.preventDefault(),this._undoEdit()):(U?i.metaKey&&i.keyCode===z&&i.shiftKey:rt?i.ctrlKey&&i.keyCode===et:i.ctrlKey&&i.keyCode===z&&i.shiftKey)&&!i.altKey?(i.preventDefault(),this._redoEdit()):i.keyCode===tt&&i.ctrlKey&&(!U||i.shiftKey)&&(i.preventDefault(),this.capture=!this.capture)}}},render:function(){var i=this,t=C("div",{class:"prism-editor__line-width-calc",style:"height: 0px; visibility: hidden; pointer-events: none;"},"999"),n=C("div",{class:"prism-editor__line-numbers",style:{"min-height":this.lineNumbersHeight},"aria-hidden":"true"},[t,Array.from(Array(this.lineNumbersCount).keys()).map(function(u,a){return C("div",{class:"prism-editor__line-number token comment"},""+ ++a)})]),s=C("textarea",{ref:"textarea",onInput:this.handleChange,onKeydown:this.handleKeyDown,onClick:function(a){i.$emit("click",a)},onKeyup:function(a){i.$emit("keyup",a)},onFocus:function(a){i.$emit("focus",a)},onBlur:function(a){i.$emit("blur",a)},class:{"prism-editor__textarea":!0,"prism-editor__textarea--empty":this.isEmpty},spellCheck:"false",autocapitalize:"off",autocomplete:"off",autocorrect:"off","data-gramm":"false",placeholder:this.placeholder,"data-testid":"textarea",readonly:this.readonly,value:this.codeData}),r=C("pre",{ref:"pre",class:"prism-editor__editor","data-testid":"preview",innerHTML:this.content}),f=C("div",{class:"prism-editor__container"},[s,r]);return C("div",{class:"prism-editor-wrapper"},[this.lineNumbers&&n,f])}});function ve(e,i){var n,s;const t=[];if(i==="object")for(const r of Object.keys(e)){if(r==="properties")for(const f of Object.keys(e.properties??{}))t.push({key:f}),(n=e.dependencies)!=null&&n[f]&&!Array.isArray(e.dependencies[f])&&t.push({key:`$deps-${f}`}),e.dependentSchemas&&e.dependentSchemas[f]&&t.push({key:`$deps-${f}`});if(r==="patternProperties"&&t.push({key:"$patternProperties"}),r==="allOf"&&(s=e.allOf)!=null&&s.length)for(let f=0;f<e.allOf.length;f++)t.push({key:`$allOf-${f}`});r==="oneOf"&&t.push({key:"$oneOf"}),r==="then"&&e.if&&t.push({key:"$then"}),r==="else"&&e.if&&t.push({key:"$else"})}if(i==="array"&&Array.isArray(e.items))for(let r=0;r<e.items.length;r++)t.push({key:r});return t}function W(e,i,t){if(!i)return e;let n=0,s=0;return i.map(r=>{if(typeof r=="string"){const f=e.find(u=>u.key===r);if(!f)throw new Error(`unknown child "${r}"`);return f}else{if(Array.isArray(r))return n++,{comp:"section",key:`$comp-${n}`,children:W(e,r,t)};if("slots"in r&&!de(r)&&(r.slots=J(r.slots,t)),"cols"in r&&(r.cols=N(r.cols)),r.if&&(r.if=D(r.if)),typeof r.cols=="number"&&(r.cols={sm:r.cols}),typeof r.cols=="object"&&r.cols.xs===void 0&&(r.cols.xs=12),r.key){if(!e.find(u=>u.key===r.key))throw new Error(`unknown child "${r.key}"`);return r}else{if(de(r))return s++,{key:`$slot-${s}`,comp:"slot",cols:N(r.cols),slots:J({component:r},t)};{const f=r;return Le(f)&&(f.comp||(f.comp="section"),f.children=W(e,f.children,t),"key"in r||(n++,f.key=`$comp-${n}`)),f}}}})}function ot(e,i,t,n){var r;if((r=e.slots)!=null&&r.component)return"slot";const s=t&&["string","integer","number"].includes(t);if(n==="oneOf")return"one-of-select";if(n==="patternProperties")return"list";if(s&&i.enum)return i.enum.length>20?"autocomplete":"select";if(s&&i.oneOf)return i.oneOf.length>20?"autocomplete":"select";if(s&&i.examples||s&&i.anyOf&&i.anyOf.length&&Object.keys(i.anyOf[i.anyOf.length-1]).length===0)return t==="string"?"combobox":"number-combobox";if(t==="string"&&e.separator)return"combobox";if(e.items)return e.items.length>20?"autocomplete":"select";if(e.getItems)return we(e.getItems)&&(e.getItems.qSearchParam||typeof e.getItems.url=="string"&&e.getItems.url.includes("{q}")||typeof e.getItems.url=="object"&&typeof e.getItems.url.expr=="string"&&e.getItems.url.expr.includes("{q}"))?"autocomplete":"select";if(t==="array"&&i.items){const f=["string","integer","number"].includes(i.items.type);if(f&&(i.items.enum||i.items.oneOf))return(i.items.enum||i.items.oneOf).length>20?"autocomplete":"select";if(f&&i.items.examples||f&&i.items.anyOf&&i.items.anyOf.length&&Object.keys(i.items.anyOf[i.items.anyOf.length-1]).length===0||f&&!i.items.layout&&!["date","date-time","time"].includes(i.items.format))return i.items.type==="string"?"combobox":"number-combobox"}if(t==="object")return"section";if(t==="array")return Array.isArray(i.items)?"section":"list";if(t==="string")return i.format==="date"?"date-picker":i.format==="date-time"?"date-time-picker":i.format==="time"?"time-picker":"text-field";if(t==="integer"||t==="number")return"number-field";if(t==="boolean")return"checkbox";throw new Error("failed to calculate default component for schema fragment")}function st(e){return Te(e)?{...e}:Me(e)?{comp:e}:qe(e)?{children:e}:{}}function lt(e){const i=typeof e=="string"?e:e.expr;return!i.includes("rootData.")&&!i.includes("rootData[")&&!i.includes("parent.data")&&!i.includes("parent.parent")}function D(e,i="js-eval",t="value"){const n=lt(e);return typeof e=="string"?{type:i,expr:e,pure:n,dataAlias:t}:{pure:n,type:i,dataAlias:t,...e}}function J(e,i){if(!e)return;const t={};for(const[n,s]of Object.entries(e))typeof s=="string"?["before","after"].includes(n)?t[n]={markdown:i(s).trim()}:t[n]={name:s}:Re(s)?t[n]={text:s.text}:Be(s)?t[n]={name:s.name,props:s.props}:Ve(s)&&(t[n]={markdown:i(s.markdown).trim()});return t}function N(e){if(typeof e=="number")return{xs:12,sm:e};if(typeof e=="object")return{xs:12,...e}}function Oe(e){if(!e)return null;const{type:i}=T(e),t=i&&["string","integer","number"].includes(i);if(e.enum&&t)return e.enum.map(n=>({key:n+"",title:n+"",value:n}));if(e.examples&&t)return e.examples.map(n=>({key:n+"",title:n+"",value:n}));if(e.anyOf&&t&&e.anyOf.length&&Object.keys(e.anyOf[e.anyOf.length-1]).length===0){const n=e.anyOf.slice(0,-1);if(!n.find(s=>!("const"in s)))return n.map(s=>({...s,key:s.const+"",title:(s.title??s.const)+"",value:s.const}))}return e.oneOf&&t&&!e.oneOf.find(n=>!("const"in n))?e.oneOf.map(n=>({...n,key:n.const+"",title:(n.title??n.const)+"",value:n.const})):null}const T=e=>{if(Array.isArray(e.type)&&e.type.length===2&&e.type.includes("null"))return{type:e.type.find(t=>t!=="null"),nullable:!0};if(!e.type&&(e.properties||e.patternProperties))return{type:"object",nullable:!1};if(!e.type){const i=[];for(const t of["allOf","anyOf","oneOf"])if(e[t])for(const n of e[t]){const{type:s}=T(n);s&&!i.includes(s)&&i.push(s)}if(i.length===1)return{type:i[0],nullable:!1}}return{type:e.type,nullable:!1}};function je(e,i,t,n,s,r,f,u,a,c,y){if("const"in t)return{comp:"none"};if(!n)return{comp:"none"};const o=st(i);if(n==="array"&&!t.items&&o.comp!=="file-input")return{comp:"none"};o.comp||(o.comp=ot(o,t,n,y));const g=f[o.comp];if(!g)throw new Error(`unknown component "${o.comp}"`);if(o.comp==="none")return{comp:"none"};if(s&&(o.nullable=s),g.composite){const d=W(ve(t,n),o.children,u);o.children=d,"title"in o||d.length===1&&d[0].key==="$patternProperties"||(o.title=t.title??null)}else if(o.comp==="list")if(y==="patternProperties"){if(!("title"in o)){const O=W(ve(t,n),o.children,u);O.length===1&&O[0].key==="$patternProperties"&&(o.title=t.title??null)}let d=!1;for(const O of Object.values(t.patternProperties??{})){const{type:j}=T(O);j==="object"&&(d=!0)}o.listEditMode=o.listEditMode??(d?"inline-single":"inline"),o.listActions=o.listActions??["add","edit","delete"],o.indexed=Object.keys(t.patternProperties??{})}else{"title"in o||(o.title=t.title??""+e);const{type:d}=T(t.items);o.listEditMode=o.listEditMode??(d==="object"?"inline-single":"inline"),o.listActions=o.listActions??["add","edit","delete","duplicate","sort"]}else o.comp!=="slot"&&!("label"in o)&&!y&&(o.label=t.title??""+e);if(g.itemsBased&&!o.items){let d;n==="array"?d=Oe(t.items):d=Oe(t),d&&(o.getItems&&ce(o.getItems)?(o.getItems.expr=JSON.stringify(d),o.getItems.immutable=!0):o.getItems={expr:JSON.stringify(d),immutable:!0})}g.multipleCompat&&(n==="array"||o.separator)&&(o.multiple=!0),o.comp==="date-picker"&&(t.format==="date"&&(o.format="date"),t.format==="date-time"&&(o.format="date-time")),["date-picker","date-time-picker","time-picker"].includes(o.comp)&&("formatMinimum"in t&&(o.min=o.min??t.formatMinimum),"formatMaximum"in t&&(o.max=o.max??t.formatMaximum)),["number-field","slider"].includes(o.comp)&&(n==="integer"&&(o.step=o.step??1),"minimum"in t&&(o.min=o.min??t.minimum),"maximum"in t&&(o.max=o.max??t.maximum)),o.if&&(o.if=D(o.if)),!o.defaultData&&t.type==="string"&&r.split("#").pop()===""&&(o.defaultData="");for(const d of c)d in o&&(o.options=o.options??{},o.options[d]=o[d],delete o[d]);if(t.readOnly&&(o.options=o.options??{},"readOnly"in o.options||(o.options.readOnly=!0)),o.getOptions!==void 0&&(o.getOptions=D(o.getOptions)),o.getDefaultData!==void 0&&(o.getDefaultData=D(o.getDefaultData)),o.getConstData!==void 0&&(o.getConstData=D(o.getConstData)),o.transformData!==void 0&&(o.transformData=D(o.transformData)),o.getProps!==void 0&&(o.getProps=D(o.getProps)),o.getItems&&Ae(o.getItems)&&(o.getItems=D(o.getItems)),o.getItems&&ce(o.getItems)){if(n==="object"&&(o.getItems.returnObjects=!0),n==="array"){const{type:d}=T(t.items);d==="object"&&(o.getItems.returnObjects=!0)}o.getItems.itemTitle&&(o.getItems.itemTitle=D(o.getItems.itemTitle,"js-eval","item")),o.getItems.itemKey&&(o.getItems.itemKey=D(o.getItems.itemKey,"js-eval","item")),o.getItems.itemValue&&(o.getItems.itemValue=D(o.getItems.itemValue,"js-eval","item")),o.getItems.itemIcon&&(o.getItems.itemIcon=D(o.getItems.itemIcon,"js-eval","item")),o.getItems.itemsResults&&(o.getItems.itemsResults=D(o.getItems.itemsResults,"js-eval","body"))}o.getItems&&we(o.getItems)&&(o.getItems.url=D(o.getItems.url,"js-tpl")),o.items&&(o.items=o.items.map(d=>{if(["string","integer","number"].includes(typeof d))return{title:d+"",key:d+"",value:d};if(typeof d=="object")return{key:(d.key??d.value)+"",title:(d.title??d.key??d.value)+"",value:d.value??d.key};throw new Error(`bad item for select: ${JSON.stringify(d)}`)})),!o.comp&&(o.items??o.getItems)&&(o.comp="select"),o.comp==="date-picker"&&t.format==="date-time"&&(o.format="date-time"),o.slots&&(o.slots=J(o.slots,u)),t.description&&(g.composite&&o.title&&a.includes("subtitle")?o.subtitle===void 0&&(o.subtitle=t.description):!g.composite&&a.includes("hint")?o.hint===void 0&&(o.hint=t.description):y!=="oneOf"&&a.includes("help")&&o.help===void 0&&(o.help=t.description)),o.help&&(o.help=u(o.help).trim()),o.subtitle&&(o.subtitle=u(o.subtitle).trim()),"cols"in o&&(o.cols=N(o.cols));const v=Ce(g);if(!v(o)){const d=new Error(`component "${g.name}" validation errors`);throw d.cause=F(v.errors),d}return o}function ft(e,i,t,n,s,r,f,u,a,c,y){if(xe(i)){const o=[],g=[...i.switch];g.find(v=>!v.if)||g.push({});for(let v=0;v<g.length;v++){const d=g[v],O=je(e,d,t,n,s,r,f,u,a,c,y);o.push(O)}return{switch:o}}else return je(e,i,t,n,s,r,f,u,a,c,y)}function Q(e,i){return e.keyword==="errorMessage"&&(e=e.params.errors[0]),i(e)}function F(e){if(!e)return[];const i=e.filter(n=>Q(n,s=>s.keyword==="anyOf"||s.keyword==="oneOf"));for(const n of i)e.find(r=>Q(r,f=>f.instancePath===n.instancePath&&f.keyword!=="type"))&&(e=e.filter(r=>Q(r,f=>f.instancePath!==n.instancePath||f.keyword!=="type")));const t=[];for(const n of e){let s=n.instancePath+" "+(n.message??n.keyword);n.params&&(s+=" "+JSON.stringify(n.params)),t.push(s)}return t}const $e=["readOnly","summary","titleDepth","density","removeAdditional","validateOn","updateOne","debounceInputMs","initialValidation","defaultOn","readOnlyPropertiesMode"];function ke(e,i,t,n,s,r,f,u,a,c){a=a?a.concat($e):$e;let y;if(c==="oneOf"?y=i.oneOfLayout??{}:c==="patternProperties"?y=i.patternPropertiesLayout??{}:y=i.layout??{},!ue(y)){const g=new Error("layout keyword validation errors at path");throw g.cause=F(ue.errors),g}const o=ft(e,y,i,t,n,s,r,f,u,a,c);if(!ae(o)){const g=new Error("normalized layout validation errors at path");throw g.cause=F(ae.errors),g}return o}function Z(e,i,t,n,s=y=>y,r,f,u,a,c){const{type:y,nullable:o}=a?{type:a,nullable:c??!1}:T(i),g=[];try{return{layout:ke(e,i,y,o,t,n,s,r,f,u),errors:g}}catch(v){try{return g.push(v.message),v.cause&&Array.isArray(v.cause)&&g.push(...v.cause),g.push("failed to normalize layout, use default component"),{layout:ke(e,{...i,layout:{}},y,o,t,n,s,r,f,u),errors:g}}catch(d){return g.push(d.message),d.cause&&Array.isArray(d.cause)&&g.push(...d.cause),g.push("failed to produce default layout, hide this fragment"),{layout:{comp:"none"},errors:g}}}}function Ie(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}function ut(){return i;function e(t,n){const s=Object.keys(t),r=new Array(s.length);for(let f=0;f<s.length;f++){const u=s[f],a=t[u];typeof a!="object"||a===null?r[u]=a:a instanceof Date?r[u]=new Date(a):ArrayBuffer.isView(a)?r[u]=Ie(a):r[u]=n(a)}return r}function i(t){if(typeof t!="object"||t===null)return t;if(t instanceof Date)return new Date(t);if(Array.isArray(t))return e(t,i);if(t instanceof Map)return new Map(e(Array.from(t),i));if(t instanceof Set)return new Set(e(Array.from(t),i));const n={};for(const s in t){if(Object.hasOwnProperty.call(t,s)===!1)continue;const r=t[s];typeof r!="object"||r===null?n[s]=r:r instanceof Date?n[s]=new Date(r):r instanceof Map?n[s]=new Map(e(Array.from(r),i)):r instanceof Set?n[s]=new Set(e(Array.from(r),i)):ArrayBuffer.isView(r)?n[s]=Ie(r):n[s]=i(r)}return n}}const R=ut(),at=(e,i)=>(t,n)=>{var c;const s=i.opts.uriResolver.resolve(t,n),[r,f]=s.split("#");if(e[r]=e[r]??((c=i.getSchema(r))==null?void 0:c.schema),!e[r])throw new Error(`reference not found ${r}`);if(!f)return[e[r],r,s];const u=f.split("/").filter(y=>!!y),{value:a}=u.reduce((y,o)=>{if(y.path.push(o),!(o in y.value))throw new Error(`reference not found ${r}#${y.path.join("/")}`);return y.value=y.value[o],y},{path:[],value:e[r]});return[a,r,s]};function ct(e,i,t="en",n="en"){if(!e.$id)throw new Error("missing schema id");const s=at({[e.$id]:e},i),r=[];return ee(e,e.$id,s,t,n,r),s}const ee=(e,i,t,n,s,r)=>{if(!r.includes(e)){r.push(e);for(const f of Object.keys(e))if(e[f]&&typeof e[f]=="object")if("$ref"in e[f]){const u=e[f].$ref.replace("~$locale~",n),a=e[f].$ref.replace("~$locale~",s);let c,y;try{[c,y]=t(i,u),e[f].$ref=u}catch{[c,y]=t(i,a),e[f].$ref=a}typeof c=="string"?e[f]=c:ee(c,y,t,n,s,r)}else ee(e[f],i,t,n,s,r)}};function dt(e,i,t){let n=null;if(e.items&&e.items.$ref){const[s]=t(i,e.items.$ref);n=n??R(e),n.items={...s,...e.items}}if(e.properties){for(const s in e.properties)if(e.properties[s].$ref){const[r]=t(i,e.properties[s].$ref);n=n??R(e),n.properties[s]={...r,...e.properties[s]}}}if(e.oneOf){for(let s=0;s<e.oneOf.length;s++)if(e.oneOf[s].$ref){const[r]=t(i,e.oneOf[s].$ref);n=n??R(e),n.oneOf[s]={...r,...e.oneOf[s]}}}if(e.anyOf){for(let s=0;s<e.anyOf.length;s++)if(e.anyOf[s].$ref){const[r]=t(i,e.anyOf[s].$ref);n=n??R(e),n.anyOf[s]={...r,...e.anyOf[s]}}}if(e.allOf){for(let s=0;s<e.allOf.length;s++)if(e.allOf[s].$ref){const[r]=t(i,e.allOf[s].$ref);n=n??R(e),n.allOf[s]={...r,...e.allOf[s]}}}return n??e}function L(e,i,t,n,s,r,f,u,a,c,y,o,g,v,d,O){var A,ie,ne,re,oe,se,le,fe;let j=i,p=e,k=o,w;e.__pointer=o,p.$ref&&([w,j,k]=n(i,p.$ref),w.__pointer=k,p={...e,...w},delete p.$ref);const M=dt(p,j,n);let{type:S,nullable:K}=T(M);if(O&&(S=O),e.errorMessage=e.errorMessage??{},!a[o]){const l=Z(y,M,o,t.components,t.markdown,t.useDescription,t.optionsKeys,void 0,S,K);a[o]=l.layout,l.errors.length&&(u[o.replace("_jl#","/")]=l.errors)}const x=a[o];let q=!d;const I=(l,b)=>{b.pure||(q=!1);const h=l.findIndex($=>$.type===b.type&&$.expr===b.expr);h!==-1?b.ref=h:(b.ref=l.length,l.push(b))},V=l=>{if(l.if&&I(c,l.if),Ge(l))for(const b of l.children)V(b)},_=Y(x)?x.switch:[x];for(const l of _){if(l.if&&I(c,l.if),pe(l,t.components))for(const h of l.children)V(h);p.const!==void 0&&l.constData===void 0&&(l.constData=p.const),l.constData!==void 0&&!l.getConstData&&(l.getConstData={type:"js-eval",expr:"layout.constData",pure:!0,dataAlias:"value"}),l.getConstData&&I(c,l.getConstData);let b;"default"in p?b=p.default:g&&(K?b=null:S==="object"&&pe(l,t.components)?b={}:S==="array"&&(b=[])),b!==void 0&&l.defaultData===void 0&&(l.defaultData=b),l.defaultData!==void 0&&!l.getDefaultData&&(l.getDefaultData={type:"js-eval",expr:"layout.defaultData",pure:!0,dataAlias:"value"}),l.getDefaultData&&I(c,l.getDefaultData),l.options!==void 0&&!l.getOptions&&(l.getOptions={type:"js-eval",expr:"layout.options",pure:!0,dataAlias:"value"}),l.getOptions&&I(c,l.getOptions),l.props!==void 0&&!l.getProps&&(l.getProps={type:"js-eval",expr:"layout.props",pure:!0,dataAlias:"value"}),l.getProps&&I(c,l.getProps),l.transformData&&I(c,l.transformData),He(l,t.components)&&l.getItems&&(Ye(l.getItems)&&I(c,l.getItems),ze(l.getItems)&&I(c,l.getItems.url),l.getItems.itemTitle&&I(c,l.getItems.itemTitle),l.getItems.itemKey&&I(c,l.getItems.itemKey),l.getItems.itemValue&&I(c,l.getItems.itemValue),l.getItems.itemIcon&&I(c,l.getItems.itemIcon),l.getItems.itemsResults&&I(c,l.getItems.itemsResults))}const m={key:y??"",pointer:o,refPointer:k,pure:q,propertyKeys:[],roPropertyKeys:[],nullable:K,required:g&&!K};if(v){if(Y(x))throw new Error("Switch struct not allowed in conditional schema");m.condition={type:"js-eval",expr:v,pure:!0,dataAlias:"value"},I(c,m.condition)}if(p.oneOf&&(e.errorMessage.oneOf=t.messages.errorOneOf),S==="object"){if(p.properties){m.children=m.children??[];for(const l of Object.keys(p.properties)){m.propertyKeys.push(l),p.properties[l].readOnly&&m.roPropertyKeys.push(l);const b=p.dependentRequired&&Object.values(p.dependentRequired).some($=>$.includes(l)),h=`${k}/properties/${l}`;if(r[h]||(r[h]="recursing",r[h]=L(p.properties[l],j,t,n,s,r,f,u,a,c,l,h,(A=p.required)==null?void 0:A.includes(l),void 0,b)),m.children.push(h),(ie=p.dependentSchemas)!=null&&ie[l]||(ne=p.dependencies)!=null&&ne[l]&&!Array.isArray(p.dependencies[l])){const $=((re=p.dependentSchemas)==null?void 0:re[l])??p.dependencies[l],E=(oe=p.dependentSchemas)!=null&&oe[l]?`${k}/dependentSchemas/${l}`:`${k}/dependencies/${l}`;r[E]||(r[E]="recursing",r[E]=L($,j,t,n,s,r,f,u,a,c,`$deps-${l}`,E,!1,`data["${l}"] !== undefined`,void 0,"object")),m.children.push(E)}}}if(p.allOf)for(let l=0;l<p.allOf.length;l++){const b=`${k}/allOf/${l}`;r[b]||(r[b]="recursing",r[b]=L(p.allOf[l],j,t,n,s,r,f,u,a,c,`$allOf-${l}`,b,!1,void 0,void 0,"object")),m.propertyKeys=m.propertyKeys.concat(r[b].propertyKeys),m.roPropertyKeys=m.roPropertyKeys.concat(r[b].roPropertyKeys),m.children=m.children??[],m.children.push(b)}if(p.oneOf){const l=`${o}/oneOf`;if(!a[l]){const h=Z("",p,l,t.components,t.markdown,t.useDescription,t.optionsKeys,"oneOf",S,K);a[l]=h.layout,h.errors.length&&(u[l.replace("_jl#","/")]=h.errors)}const b=[];for(let h=0;h<p.oneOf.length;h++){p.oneOf[h].type||(p.oneOf[h].type=S);const $=p.oneOf[h].title??`option ${h}`;delete p.oneOf[h].title;const E=`${l}/${h}`;s[E]||(s[E]="recursing",s[E]=G(p.oneOf[h],j,t,n,s,r,f,u,a,c,E,$)),b.push(E)}r[l]||(r[l]={key:"$oneOf",pointer:l,refPointer:l,childrenTrees:b,pure:!b.some(h=>{var $;return!r[($=s[h])==null?void 0:$.root].pure}),propertyKeys:[],roPropertyKeys:[]}),m.children=m.children??[],m.children.push(l)}if(p.patternProperties){const l=`${o}/patternProperties`;if(!a[l]){const h=Z("",p,l,t.components,t.markdown,t.useDescription,t.optionsKeys,"patternProperties",S,K);a[l]=h.layout,h.errors.length&&(u[l.replace("_jl#","/")]=h.errors)}const b=[];for(const h of Object.keys(p.patternProperties)){const $=`${l}/${h}`;if(!s[$]){s[$]="recursing",s[$]=G(p.patternProperties[h],j,t,n,s,r,f,u,a,c,$,"pattern "+h);const E=a[r[s[$].root].pointer];if(Y(E))for(const Pe of E.switch)Pe.nullable=!0;else E.nullable=!0}b.push($)}r[l]||(r[l]={key:"$patternProperties",pointer:l,refPointer:l,childrenTrees:b,pure:!b.some(h=>{var $;return!r[($=s[h])==null?void 0:$.root].pure}),propertyKeys:[],roPropertyKeys:[]}),m.children=m.children??[],m.children.push(l)}if(p.if){if(f.push(`${o}/if`),p.then){const l=`${k}/then`;r[l]||(r[l]="recursing",r[l]=L(p.then,j,t,n,s,r,f,u,a,c,"$then",l,!1,`validates["${o}/if"](data)`,void 0,"object")),m.children=m.children??[],m.children.push(l)}if(p.else){const l=`${k}/else`;r[l]||(r[l]="recursing",r[l]=L(p.else,j,t,n,s,r,f,u,a,c,"$else",l,!1,`!validates["${o}/if"](data)`,void 0,"object")),m.children=m.children??[],m.children.push(l)}}for(const l of m.propertyKeys)(se=p==null?void 0:p.required)!=null&&se.includes(l)&&(e.errorMessage.required=e.errorMessage.required??{},e.errorMessage.required[l]=t.messages.errorRequired),p.dependentRequired&&Object.keys(p.dependentRequired).includes(l)&&(e.errorMessage.dependentRequired=t.messages.errorRequired)}if(S==="array"&&p.items)if(Array.isArray(p.items)){m.children=m.children??[];for(let l=0;l<p.items.length;l++){const b=p.items[l],h=`${k}/items/${l}`;r[h]||(r[h]="recursing",r[h]=L(b,j,t,n,s,r,f,u,a,c,l,h,!0)),m.children.push(h)}}else{const l=`${o}/items`;s[l]||(s[l]="recursing",s[l]=G(p.items,j,t,n,s,r,f,u,a,c,l,p.items.title)),m.childrenTrees=[l];const b=a[r[s[l].root].pointer];if(Y(b))for(const h of b.switch)h.nullable=!0;else b.nullable=!0}for(const l of m.children||[])r[l].pure||(m.pure=!1);for(const l of m.childrenTrees||[])(fe=r[(le=s[l])==null?void 0:le.root])!=null&&fe.pure||(m.pure=!1);return m}function G(e,i,t,n,s,r,f,u,a,c,y,o){return r[y]||(r[y]="recursing",r[y]=L(e,i,t,n,s,r,f,u,a,c,"",y,!0),f.push(r[y].refPointer)),{title:o,root:y,refPointer:r[y].refPointer}}const te=(e,i,t="en")=>{for(const[n,s]of Object.entries(e)){if(n.startsWith("x-i18n-")){typeof s!="object"&&console.error(`i18n property ${n} should be an object`);const r=n.replace("x-i18n-","");e[r]=s[i]??s[t]??e[r],delete e[n]}else if(Array.isArray(s))for(const r of s)te(r,i,t);typeof s=="object"&&te(s,i,t)}},pt={errorOneOf:"choisissez une valeur",errorRequired:"information obligatoire",addItem:"Ajouter un élément",delete:"Supprimer",edit:"Éditer",close:"Fermer",duplicate:"Dupliquer",sort:"Trier",up:"Décaler vers le haut",down:"Décaler vers le bas",showHelp:"Afficher un message d'aide",mdeLink1:"[titre du lien",mdeLink2:"](adresse du lien)",mdeImg1:"![](",mdeImg2:"adresse de l'image)",mdeTable1:"",mdeTable2:`

| Colonne 1 | Colonne 2 | Colonne 3 |
| -------- | -------- | -------- |
| Texte     | Texte     | Texte     |

`,bold:"Gras",italic:"Italique",heading:"Titre",quote:"Citation",unorderedList:"Liste à puce",orderedList:"Liste numérotée",createLink:"Créer un lien",insertImage:"Insérer une image",createTable:"Créer un tableau",preview:"Preview",mdeGuide:"Syntax documentation",undo:"Défaire",redo:"Refaire"},yt={errorOneOf:"Kies er een",errorRequired:"benodigde informatie",addItem:"Item toevoegen",delete:"Verwijderen",edit:"Bewerken",close:"Sluiten",duplicate:"Verveelvoudigen",sort:"Sorteren",up:"Omhoog verplaatsen",down:"Omlaag verplaatsen",showHelp:"Toon helpbericht",mdeLink1:"[Link titel",mdeLink2:"](link url)",mdeImg1:"![](",mdeImg2:"afbeelding url)",mdeTable1:"",mdeTable2:`

| Kolom 1  | Kolom 2  | Kolom 3  |
| -------- | -------- | -------- |
| Tekst    | Tekst    | Tekst    |

`,bold:"Vet",italic:"Cursief",heading:"Titel",quote:"Citaat",unorderedList:"Ongeordende lijst",orderedList:"Geordende lijst",createLink:"Maak een koppeling",insertImage:"Afbeelding invoegen",createTable:"Tabel aanmaken",preview:"Voorbeeld",mdeGuide:"Documentatie over syntaxis",undo:"Ongedaan maken",redo:"Opnieuw"},mt={errorOneOf:"Wählen Sie eine Option",errorRequired:"Erforderliche Information",addItem:"Element hinzufügen",delete:"Löschen",edit:"Bearbeiten",close:"Schließen",duplicate:"Duplizieren",sort:"Sortieren",up:"Nach oben verschieben",down:"Nach unten verschieben",showHelp:"Hilfemeldung anzeigen",mdeLink1:"[Link-Titel",mdeLink2:"](Link-URL)",mdeImg1:"![](",mdeImg2:"Bild-URL)",mdeTable1:"",mdeTable2:`

| Spalte 1 | Spalte 2 | Spalte 3 |
| -------- | -------- | -------- |
| Text     | Text     | Text     |

`,bold:"Fett",italic:"Kursiv",heading:"Titel",quote:"Zitat",unorderedList:"Ungeordnete Liste",orderedList:"Geordnete Liste",createLink:"Link erstellen",insertImage:"Bild einfügen",createTable:"Tabelle erstellen",preview:"Vorschau",mdeGuide:"Syntax-Dokumentation",undo:"Rückgängig",redo:"Wiederholen"},Ee={en:Xe,fr:pt,nl:yt,de:mt};function ht(e=[],i=[]){if(!e||!i)return e===i;if(e.length!==i.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==i[t])return!1;return!0}const gt=Ze,bt=e=>{let i=e.ajv;if(!i){const u={allErrors:!0,strict:!1,verbose:!0};e.ajvOptions&&Object.assign(u,e.ajvOptions),e.code&&(u.code={source:!0,esm:!0,lines:!0});const a=new gt(u);Ue.default(a),Qe.default(a),i=a}i.addKeyword("layout");let t=e.markdown;t||(t=a=>_e.parse(a,e.markedOptions));const n=e.defaultLocale||"en",s=e.locale||n,r={...Ee[s]||Ee[n]};e.messages&&Object.assign(r,e.messages);const f=We.reduce((u,a)=>(u[a.name]=a,u),{});if(e.components){for(const u of Object.keys(e.components))f[u]={...e.components[u],name:u};Object.assign(f,e.components)}return{ajv:i,code:!1,markdown:t,optionsKeys:[],useDescription:["help","subtitle"],...e,locale:s,defaultLocale:n,messages:r,components:f,xI18n:!!e.xI18n}};P((e,i)=>{for(const t of["ajv","ajvOptions","code","markdown","markedOptions","xI18n","locale","defaultLocale","messages","optionsKeys","components","useDescription"])if(t in i){if(t==="components"&&ht(Object.keys(e.components??[]),Object.keys(i.components??[])))continue;e[t]=i[t]}else delete e[t]});const De=Ke;function St(e,i={}){const t=bt(i),n=R(e);n.$id=n.$id??"_jl";const s=ct(n,t.ajv,t.locale,t.defaultLocale);t.xI18n&&te(n,t.locale,t.defaultLocale);const r=[],f={},u=[],a={},c={},y={},o=`${n.$id}#`;c[o]="recursing",c[o]=G(n,n.$id,t,s,c,y,r,a,f,u,o,"main"),t.ajv.addSchema(n);const g=t.ajv.opts.uriResolver,v={};for(const O of r){const j=g.resolve(n.$id,O);v[O]=t.ajv.compile({$ref:j})}const d=[];for(const O of u){const j=O.pure?["data",O.dataAlias,"options","context","display","layout","readOnly","summary","validates"]:["data",O.dataAlias,"options","context","display","layout","readOnly","summary","validates","rootData","parent"];O.type==="js-fn"&&d.push(new Function(...j,O.expr)),O.type==="js-eval"&&d.push(new Function(...j,"return ("+O.expr+")")),O.type==="js-tpl"&&d.push(new Function(...j,"return `"+O.expr+"`"))}return Object.keys(a).length&&console.error("JSON layout encountered some validation errors:",a),{options:t,schema:n,mainTree:o,skeletonTrees:c,skeletonNodes:y,validates:v,validationErrors:a,normalizedLayouts:f,expressions:d,locale:t.locale,messages:t.messages,components:t.components,localizeErrors:De[t.locale]||De.en}}const X={};function vt(e){return X[e]=X[e]??new RegExp(e),X[e]}B("jl:state-node");B("jl:validation");P((e,i,t,n,s,r,f,u,a,c,y,o,g,v,d,O,j,p,k)=>{if(e.messages=u.messages?Ot(e.messages||{},u.messages,v):v.messages,e.key=i,e.fullKey=t,e.parentFullKey=n,e.dataPath=s,e.parentDataPath=r,e.skeleton=f,e.layout=u,e.width=a,e.options=v,e.cols=c,e.data=y,e.error=o,e.itemsCacheKey=p,e.childError=k&&k.findIndex(w=>w.error||w.childError)!==-1,e.validated=g,d)e.autofocus=!0,delete e.autofocusChild;else{delete e.autofocus;const w=k==null?void 0:k.find(M=>M.autofocus);w?e.autofocusChild=w.key:delete e.autofocusChild}e.props=O,e.slots=j,e.children=k});const Ot=P((e,i,t)=>{Object.assign(e,t.messages,i)});P((e,i)=>{for(const t of i){const n=t.key;t.data===void 0?delete e[n]:e[n]=t.data}for(;e.length&&e[e.length-1]===void 0;)e.pop()});P((e,i,t,n,s)=>{for(let r=0;r<e.length;r++)e[r]instanceof File||(e[r]=jt(e[r],i+"/"+r,void 0,t,n,s))});const jt=P((e,i,t,n,s,r)=>{if(s&&(s.length||t!=null&&t.length))for(const f of Object.keys(e))s.includes(f)||delete e[f];if(r)for(const f of r)delete e[f];if(t)for(const f of t)if(i===f.dataPath){if(f.data===void 0)continue;Object.assign(e,f.data)}else f.data===void 0?delete e[f.key]:e[f.key]=f.data;if(n)for(const f of n)f.instancePath===i&&(f.keyword==="additionalProperties"&&delete e[f.params.additionalProperty],f.keyword==="unevaluatedProperties"&&delete e[f.params.unevaluatedProperty])});P((e,i,t,n)=>{for(const s of Object.keys(i))t.includes(s)||n.some(r=>!!s.match(vt(r)))&&(e[s]=i[s]);for(const s of Object.keys(e))s in i||delete e[s]});P((e,i,t={})=>{for(const n in i)e[n]=t[n]??i[n];for(const n in t)e[n]=t[n];for(const n in e)!(n in i)&&!(n in t)&&delete e[n]});P(e=>{e.readOnly=!0,e.summary=!0});P((e,i)=>{i.title&&e.titleDepth<6&&(e.titleDepth+=1)});P((e,i,t)=>{if(i.dataPath===i.parentDataPath){if(Object.assign(e,t),i.data&&typeof t=="object"&&t!==null)for(const n of Object.keys(i.data))n in t||delete e[n]}else e[i.key]=t});B("jl:validation");P((e,i,t)=>{e.root=i,e.valid=t});B("jl:data-binding");B("jl:select-items");B("jl:activated-items");export{Pt as P,St as c};
