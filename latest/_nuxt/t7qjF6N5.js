import{P as I,Y as P}from"./D42CBQBB.js";import{P as O}from"./CcJ_VqHP.js";import{a as R,V as S}from"./DoF1WQlH.js";import{a as q}from"./C7_s53Y-.js";import{r as p,R as T,t as y,D as h,A as r,z as o,E as t,B as g,F as N,o as A,i as U,V as G,W as K,K as Y,v as Q,J as X,I as Z,x as B,y as J,U as ee}from"./CZ0VzNGo.js";import{f as ae,a as D,g as le,i as $,b as te,_ as oe,V as F,o as re}from"./CnLmlt50.js";import{w as se,u as ue,c as ne}from"./BwQ2Lr2j.js";import{V as z}from"./BTICCGGt.js";import{e as ie,V as de}from"./B7o2PRZw.js";import{u as me}from"./B2CAr1a5.js";import{V as L}from"./Bd3hRkm4.js";import{V as M}from"./DgCIcw6x.js";import{V as ve}from"./CkRxGyZI.js";import"./BosuxZz1.js";import"./BKjTprnq.js";import"./BfZqBC51.js";import"./DfOvycOU.js";import"./CkKyo0Au.js";import"./CwomPCMa.js";/* empty css        */const pe={__name:"object-editor",props:{modelValue:{type:[Object,String,Number,Boolean,Array],required:!0},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","update:parseError"],setup(E,{emit:x}){O.manual=!0;const u=E,n=x,s=p({}),v=p("json"),d=p("{}"),j=(i,l)=>(l=l??v.value,l==="yaml"?P.parse(i):JSON.parse(i)),c=(i,l)=>(l=l??v.value,l==="yaml"?P.stringify(i):JSON.stringify(i,null,2));T(v,()=>{d.value=c(s.value)});const V=i=>{try{s.value=j(i),n("update:modelValue",s.value),n("update:parseError",null)}catch(l){n("update:parseError",l.message)}};T(()=>u.modelValue,()=>{u.modelValue!==s.value&&(s.value=JSON.parse(JSON.stringify(u.modelValue)),d.value=c(s.value))},{immediate:!0});const w=i=>O.highlight(i,O.languages[v.value],v.value);return(i,l)=>(y(),h(t(ae),{style:{position:"relative","background-color":"white"}},{default:r(()=>[o(t(R),{class:"rounded-0 rounded-bs-xl",rounded:"bs",density:"compact",variant:"elevated",elevation:"1",theme:"light",style:{position:"absolute",top:"0",right:"0","z-index":"200",height:"24px"}},{default:r(()=>[o(t(S),{size:"small",color:v.value==="json"?"primary":"",onClick:l[0]||(l[0]=f=>v.value="json")},{default:r(()=>l[4]||(l[4]=[g(" JSON ")])),_:1},8,["color"]),o(t(S),{size:"small",color:v.value==="yaml"?"primary":"",onClick:l[1]||(l[1]=f=>v.value="yaml")},{default:r(()=>l[5]||(l[5]=[g(" YAML ")])),_:1},8,["color"]),E.readonly?N("",!0):(y(),h(t(S),{key:0,size:"small",onClick:l[2]||(l[2]=f=>d.value=c(s.value))},{default:r(()=>[o(t(q),null,{default:r(()=>l[6]||(l[6]=[g("mdi-format-align-left")])),_:1})]),_:1}))]),_:1}),o(t(I),{modelValue:d.value,"onUpdate:modelValue":[l[3]||(l[3]=f=>d.value=f),V],class:"vjsf-code-editor py-2",style:{"min-height":"200px"},highlight:w,"line-numbers":"",readonly:E.readonly},null,8,["modelValue","readonly"])]),_:1}))}},fe={class:"text-caption"},ce=["value","onInput"],Te={__name:"editor",setup(E){const x=ie[0].examples[0],u=p(null),n=p(null),s=p(null);A(()=>{const m=window.localStorage.getItem("vjsf-editor-state");if(m){const e=JSON.parse(m);u.value=e.schema,n.value=e.options??{},s.value=e.data??{}}else u.value=x.schema,n.value=x.options??{},s.value=x.data??{};se([u,n,s],()=>{window.localStorage.setItem("vjsf-editor-state",JSON.stringify({schema:u.value,options:n.value,data:s.value}))},{debounce:500,immediate:!0})});const v=[{value:"schema",title:"Schema"},{value:"options",title:"Options"},{value:"data",title:"Data"}],d=p("schema"),{height:j}=ue(),c=U(()=>j.value-56),V=p({}),w=p(null);T([u,n],()=>{if(!n.value||!u.value)return;let m;try{m=re(u.value,{...ne,...n.value,components:{[z.info.name]:z.info}}),V.value=m.validationErrors}catch(e){V.value={"":[e.message]}}Object.keys(V.value).length||(w.value={options:{...n.value,plugins:[z]},schema:u.value})},{immediate:!0});const i=G({}),l=(m,e)=>{e?i[m]=e:delete i[m]},f=U(()=>{const m={...i,...V.value};return Object.keys(m).length?P.stringify(m).trim():""}),_=p(null),b=p(null),W=U(()=>b.value===!1?"error":b.value===!0?"success":"default");return me({title:"VJSF - Editor"}),A(()=>{document.getElementsByTagName("html")[0].style.overflowY="hidden"}),K(()=>{document.getElementsByTagName("html")[0].style.overflowY=""}),(m,e)=>{const C=pe;return u.value&&n.value&&s.value!==void 0?(y(),h(t(ve),{key:0,fluid:"",class:"pa-0"},{default:r(()=>[o(t(F),{dense:""},{default:r(()=>[o(t(D),{class:"ml-2"},{default:r(()=>[o(t(L),{variant:"outlined",color:f.value?"error":"grey",class:"pa-0",style:Y(`max-height: ${c.value-8}px;overflow-y: auto;`)},{default:r(()=>[o(t(de),{density:"compact"},{default:r(()=>[(y(),Q(Z,null,X(v,a=>o(t(S),{key:a.value,class:"text-none font-weight-bold",size:"small",variant:d.value===a.value?"flat":"text",active:d.value===a.value,color:d.value===a.value?"primary":"",onClick:k=>d.value=a.value},{default:r(()=>[g(J(a.title),1)]),_:2},1032,["variant","active","color","onClick"])),64)),o(t(M))]),_:1}),o(t(le),{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=a=>d.value=a)},{default:r(()=>[o(t($),{value:"schema"},{default:r(()=>[o(C,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),"onUpdate:parseError":e[1]||(e[1]=a=>l("schema",a))},null,8,["modelValue"])]),_:1}),o(t($),{value:"options"},{default:r(()=>[o(C,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value=a),"onUpdate:parseError":e[3]||(e[3]=a=>l("options",a))},null,8,["modelValue"])]),_:1}),o(t($),{value:"data"},{default:r(()=>[o(C,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value=a),"onUpdate:parseError":e[5]||(e[5]=a=>l("schema",a))},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),f.value?(y(),h(t(L),{key:0,color:"error",variant:"text",class:"pa-2"},{default:r(()=>[B("pre",fe,J(f.value),1)]),_:1})):N("",!0)]),_:1},8,["color","style"])]),_:1}),o(t(D),null,{default:r(()=>[B("div",{style:Y(`max-height: ${c.value-8}px;overflow-y: auto;`)},[w.value?(y(),h(t(te),{key:0,ref_key:"form",ref:_,modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=a=>b.value=a),class:"mr-4"},{default:r(()=>[o(t(oe),ee({modelValue:s.value,"onUpdate:modelValue":e[7]||(e[7]=a=>s.value=a)},w.value),{"custom-textarea":r(({node:a,statefulLayout:k})=>[B("textarea",{value:a.data,style:{border:"1px solid red"},placeholder:"A custom textarea",onInput:H=>k.input(a,H.target.value)},null,40,ce)]),"custom-message":r(({node:a})=>[g(" This message is defined in a slot (key="+J(a.key)+") ",1)]),_:1},16,["modelValue"]),o(t(F),{class:"ma-0"},{default:r(()=>[o(t(M)),o(t(S),{color:W.value,flat:"",class:"ma-2",onClick:e[8]||(e[8]=a=>{var k;return(k=_.value)==null?void 0:k.validate()})},{default:r(()=>e[10]||(e[10]=[g(" Validate ")])),_:1},8,["color"])]),_:1})]),_:1},8,["modelValue"])):N("",!0)],4)]),_:1})]),_:1})]),_:1})):N("",!0)}}};export{Te as default};
