import{Y as _}from"./D8Oal-HQ.js";import{P as B}from"./CN5uW8HJ.js";import{P as R,w as Z,u as Q}from"./C4FwdV2Q.js";import{a as X,V as k}from"./D1Ema_iq.js";import{r as v,V as P,D as V,v as c,A as r,z as o,E as t,F as C,B as x,K as z,o as Y,j as U,Z as ee,$ as ae,t as te,I as le,J as oe,y as b,x as D,W as re}from"./BQ4DIMAD.js";import{a as A}from"./LYhvEHL8.js";import{f as I,e as se,b as J,i as ue,_ as ne,n as ie}from"./cn-G9MQ7.js";import{a as de}from"./CL1qVdRa.js";import{V as T}from"./C660TNbQ.js";import"./B8C66oTJ.js";import{e as me,V as ve}from"./CO4pUTyO.js";import{u as pe}from"./eHzwsF_9.js";import{a as F,V as M}from"./mcE45wIK.js";import{V as W}from"./BG_m-q8j.js";import{V as H}from"./CZEjMuJX.js";import{d as fe}from"./EKIVRTgg.js";import{V as ce}from"./BBuxwdaE.js";import{V as ye}from"./CyBvoUdF.js";import"./BosuxZz1.js";import"./mDfEz_Ao.js";import"./Cj5kdm3m.js";import"./DxkzZux7.js";/* empty css        */const ge={__name:"object-editor",props:{modelValue:{type:[Object,String,Number,Boolean,Array],required:!0},readonly:{type:Boolean,default:!1},defaultLanguage:{type:String,default:"json"}},emits:["update:modelValue","update:parseError"],setup(E,{emit:w}){B.manual=!0;const u=E,n=w,s=v({}),d=v(u.defaultLanguage),y=v("{}"),p=(i,l)=>(l=l??d.value,l==="yaml"?_.parse(i):JSON.parse(i)),S=(i,l)=>(l=l??d.value,l==="yaml"?_.stringify(i):JSON.stringify(i,null,2));P(d,()=>{y.value=S(s.value)});const j=i=>{try{s.value=p(i),n("update:modelValue",s.value),n("update:parseError",null)}catch(l){n("update:parseError",l.message)}};P(()=>u.modelValue,()=>{u.modelValue!==s.value&&(s.value=JSON.parse(JSON.stringify(u.modelValue)),y.value=S(s.value))},{immediate:!0});const h=i=>B.highlight(i,B.languages[d.value],d.value);return(i,l)=>(c(),V(t(I),{style:{position:"relative","background-color":"white"}},{default:r(()=>[o(t(X),{class:"rounded-0 rounded-bs-xl",rounded:"bs",density:"compact",variant:"elevated",elevation:"1",style:{position:"absolute",top:"0",right:"0","z-index":"200",height:"24px"}},{default:r(()=>[o(t(k),{size:"small",color:d.value==="json"?"primary":"",onClick:l[0]||(l[0]=f=>d.value="json")},{default:r(()=>l[4]||(l[4]=[x(" JSON ")])),_:1},8,["color"]),o(t(k),{size:"small",color:d.value==="yaml"?"primary":"",onClick:l[1]||(l[1]=f=>d.value="yaml")},{default:r(()=>l[5]||(l[5]=[x(" YAML ")])),_:1},8,["color"]),E.readonly?C("",!0):(c(),V(t(k),{key:0,size:"small",onClick:l[2]||(l[2]=f=>y.value=S(s.value))},{default:r(()=>[o(t(A),null,{default:r(()=>l[6]||(l[6]=[x("mdi-format-align-left")])),_:1})]),_:1}))]),_:1}),o(t(R),{modelValue:y.value,"onUpdate:modelValue":[l[3]||(l[3]=f=>y.value=f),j],class:"vjsf-code-editor py-2",style:z(`min-height:200px; background-color: ${i.$vuetify.theme.current.colors.background}`),highlight:h,"line-numbers":"",readonly:E.readonly},null,8,["modelValue","style","readonly"])]),_:1}))}},Ve={class:"text-caption"},he=["value","onInput"],Me={__name:"editor",setup(E){const w=me[0].examples[0],u=v(null),n=v(null),s=v(null),d=v("light");Y(()=>{const m=window.localStorage.getItem("vjsf-editor-state");if(m){const e=JSON.parse(m);u.value=e.schema,n.value=e.options??{},s.value=e.data??{}}else u.value=w.schema,n.value=w.options??{},s.value=w.data??{};Z([u,n,s],()=>{window.localStorage.setItem("vjsf-editor-state",JSON.stringify({schema:u.value,options:n.value,data:s.value}))},{debounce:500,immediate:!0})});const y=[{value:"schema",title:"Schema"},{value:"options",title:"Options"},{value:"data",title:"Data"}],p=v("schema"),{height:S}=Q(),j=U(()=>S.value-56),h=v({}),i=v(null);P([u,n],()=>{if(!n.value||!u.value)return;let m;try{m=ie(u.value,{...de,...n.value,components:{[T.info.name]:T.info}}),h.value=m.validationErrors}catch(e){h.value={"":[e.message]}}Object.keys(h.value).length||(i.value={options:{...n.value,plugins:[T]},schema:u.value})},{immediate:!0});const l=ee({}),f=(m,e)=>{e?l[m]=e:delete l[m]},O=U(()=>{const m={...l,...h.value};return Object.keys(m).length?_.stringify(m).trim():""}),L=v(null),N=v(null),q=U(()=>N.value===!1?"error":N.value===!0?"success":"default"),G=()=>{d.value=d.value==="light"?"dark":"light"};return pe({title:"VJSF - Editor"}),Y(()=>{document.getElementsByTagName("html")[0].style.overflowY="hidden"}),ae(()=>{document.getElementsByTagName("html")[0].style.overflowY=""}),(m,e)=>{const $=ge;return n.value&&s.value!==void 0?(c(),V(t(ye),{key:0,fluid:"",class:"pa-0"},{default:r(()=>[o(t(F),{dense:""},{default:r(()=>[o(t(M),{class:"ml-2"},{default:r(()=>[o(t(W),{variant:"outlined",color:O.value?"error":"grey",class:"pa-0",style:z(`max-height: ${j.value-8}px;overflow-y: auto;`)},{default:r(()=>[o(t(ve),{density:"compact",color:"surface"},{default:r(()=>[(c(),te(le,null,oe(y,a=>o(t(k),{key:a.value,class:"text-none font-weight-bold ml-2",variant:p.value===a.value?"flat":"text",active:p.value===a.value,color:p.value===a.value?"primary":"",onClick:g=>p.value=a.value},{default:r(()=>[x(b(a.title),1)]),_:2},1032,["variant","active","color","onClick"])),64)),o(t(H)),o(t(k),{icon:"",color:"primary",class:"mr-2",onClick:G},{default:r(()=>[d.value==="light"?(c(),V(t(A),{key:0,icon:"mdi-weather-night"})):(c(),V(t(A),{key:1,icon:"mdi-weather-sunny"}))]),_:1})]),_:1}),o(t(fe)),o(t(se),{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value=a)},{default:r(()=>[o(t(J),{value:"schema"},{default:r(()=>[o($,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),"default-language":"yaml","onUpdate:parseError":e[1]||(e[1]=a=>f("schema",a))},null,8,["modelValue"])]),_:1}),o(t(J),{value:"options"},{default:r(()=>[o($,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value=a),"default-language":"yaml","onUpdate:parseError":e[3]||(e[3]=a=>f("options",a))},null,8,["modelValue"])]),_:1}),o(t(J),{value:"data"},{default:r(()=>[o($,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value=a),"onUpdate:parseError":e[5]||(e[5]=a=>f("schema",a))},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),O.value?(c(),V(t(W),{key:0,color:"error",variant:"text",class:"pa-2"},{default:r(()=>[D("pre",Ve,b(O.value),1)]),_:1})):C("",!0)]),_:1},8,["color","style"])]),_:1}),o(t(M),{class:"pr-3"},{default:r(()=>[o(t(I),{style:z(`max-height: ${j.value-8}px;overflow-y: auto;`),rounded:"",border:"sm"},{default:r(()=>[o(t(ce),{theme:d.value,"with-background":""},{default:r(()=>[i.value?(c(),V(t(ue),{key:0,ref_key:"form",ref:L,modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=a=>N.value=a),class:"mx-3 mt-3"},{default:r(()=>[o(t(ne),re({modelValue:s.value,"onUpdate:modelValue":e[7]||(e[7]=a=>s.value=a)},i.value),{"custom-textarea":r(({node:a,statefulLayout:g})=>[D("textarea",{value:a.data,style:{border:"1px solid red"},placeholder:"A custom textarea",onInput:K=>g.input(a,K.target.value)},null,40,he)]),"custom-message":r(({node:a,prop1:g})=>[x(" This message is defined in a slot (key="+b(a.key)+", data="+b(a.data)+", additional prop="+b(g)+") ",1)]),_:1},16,["modelValue"]),o(t(F),{class:"ma-0"},{default:r(()=>[o(t(H)),o(t(k),{color:q.value,flat:"",class:"my-2",onClick:e[8]||(e[8]=a=>{var g;return(g=L.value)==null?void 0:g.validate()})},{default:r(()=>e[10]||(e[10]=[x(" Validate ")])),_:1},8,["color"])]),_:1})]),_:1},8,["modelValue"])):C("",!0)]),_:1},8,["theme"])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})):C("",!0)}}};export{Me as default};
