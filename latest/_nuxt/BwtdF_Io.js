import{Y as _}from"./wCmIKGRh.js";import{P as B}from"./CN5uW8HJ.js";import{P as R,c as Q}from"./Dkuh1AvK.js";import{d as X,V as h}from"./rlTVwQlV.js";import{r as v,ab as P,t as c,D as g,A as r,z as o,E as a,B as k,F as j,K as z,o as Y,i as U,aI as Z,aM as ee,v as ae,J as te,I as le,x as D,y as $,a0 as oe}from"./BD5tCmfc.js";import{V as A}from"./BZRo1uxH.js";import{V as H,a as re,b as J,c as se}from"./Ct0-TAeR.js";import{w as ue,u as ne,a as ie}from"./QPeKqwTM.js";import{b as de,_ as me}from"./DP8LyDvu.js";import{a as M,V as F,b as T}from"./Bl3SbxTS.js";import{e as ve,a as pe,V as I}from"./B2EWe7wn.js";import{u as fe}from"./XArD1J05.js";import{V as W}from"./DDy7oN22.js";import{d as ce}from"./Bz-k_Q14.js";import{V as ye}from"./DiAEX38i.js";import"./Dir275Eu.js";import"./BosuxZz1.js";import"./kY6r_Lxp.js";import"./fzY2AWXp.js";import"./D2eeoPER.js";import"./eEAGVwnq.js";import"./Cc48LRZp.js";import"./DT2hPYvV.js";import"./UVsxQyNN.js";/* empty css        */const ge={__name:"object-editor",props:{modelValue:{type:[Object,String,Number,Boolean,Array],required:!0},readonly:{type:Boolean,default:!1},defaultLanguage:{type:String,default:"json"}},emits:["update:modelValue","update:parseError"],setup(S,{emit:x}){B.manual=!0;const u=S,n=x,s=v({}),d=v(u.defaultLanguage),y=v("{}"),p=(i,l)=>(l=l??d.value,l==="yaml"?_.parse(i):JSON.parse(i)),w=(i,l)=>(l=l??d.value,l==="yaml"?_.stringify(i):JSON.stringify(i,null,2));P(d,()=>{y.value=w(s.value)});const E=i=>{try{s.value=p(i),n("update:modelValue",s.value),n("update:parseError",null)}catch(l){n("update:parseError",l.message)}};P(()=>u.modelValue,()=>{u.modelValue!==s.value&&(s.value=JSON.parse(JSON.stringify(u.modelValue)),y.value=w(s.value))},{immediate:!0});const V=i=>B.highlight(i,B.languages[d.value],d.value);return(i,l)=>(c(),g(a(H),{style:{position:"relative","background-color":"white"}},{default:r(()=>[o(a(X),{class:"rounded-0 rounded-bs-xl",rounded:"bs",density:"compact",variant:"elevated",elevation:"1",style:{position:"absolute",top:"0",right:"0","z-index":"200",height:"24px"}},{default:r(()=>[o(a(h),{size:"small",color:d.value==="json"?"primary":"",onClick:l[0]||(l[0]=f=>d.value="json")},{default:r(()=>l[4]||(l[4]=[k(" JSON ")])),_:1},8,["color"]),o(a(h),{size:"small",color:d.value==="yaml"?"primary":"",onClick:l[1]||(l[1]=f=>d.value="yaml")},{default:r(()=>l[5]||(l[5]=[k(" YAML ")])),_:1},8,["color"]),S.readonly?j("",!0):(c(),g(a(h),{key:0,size:"small",onClick:l[2]||(l[2]=f=>y.value=w(s.value))},{default:r(()=>[o(a(A),null,{default:r(()=>l[6]||(l[6]=[k("mdi-format-align-left")])),_:1})]),_:1}))]),_:1}),o(a(R),{modelValue:y.value,"onUpdate:modelValue":[l[3]||(l[3]=f=>y.value=f),E],class:"vjsf-code-editor py-2",style:z(`min-height:200px; background-color: ${i.$vuetify.theme.current.colors.background}`),highlight:V,"line-numbers":"",readonly:S.readonly},null,8,["modelValue","style","readonly"])]),_:1}))}},Ve={class:"text-caption"},he=["value","onInput"],We={__name:"editor",setup(S){const x=ve[0].examples[0],u=v(null),n=v(null),s=v(null),d=v("light");Y(()=>{const m=window.localStorage.getItem("vjsf-editor-state");if(m){const e=JSON.parse(m);u.value=e.schema,n.value=e.options??{},s.value=e.data??{}}else u.value=x.schema,n.value=x.options??{},s.value=x.data??{};ue([u,n,s],()=>{window.localStorage.setItem("vjsf-editor-state",JSON.stringify({schema:u.value,options:n.value,data:s.value}))},{debounce:500,immediate:!0})});const y=[{value:"schema",title:"Schema"},{value:"options",title:"Options"},{value:"data",title:"Data"}],p=v("schema"),{height:w}=ne(),E=U(()=>w.value-56),V=v({}),i=v(null);P([u,n],()=>{if(!n.value||!u.value)return;let m;try{m=Q(u.value,{...ie,...n.value,components:{[T.info.name]:T.info}}),V.value=m.validationErrors}catch(e){V.value={"":[e.message]}}Object.keys(V.value).length||(i.value={options:{...n.value,plugins:[T]},schema:u.value})},{immediate:!0});const l=Z({}),f=(m,e)=>{e?l[m]=e:delete l[m]},C=U(()=>{const m={...l,...V.value};return Object.keys(m).length?_.stringify(m).trim():""}),L=v(null),N=v(null),q=U(()=>N.value===!1?"error":N.value===!0?"success":"default"),G=()=>{d.value=d.value==="light"?"dark":"light"};return fe({title:"VJSF - Editor"}),Y(()=>{document.getElementsByTagName("html")[0].style.overflowY="hidden"}),ee(()=>{document.getElementsByTagName("html")[0].style.overflowY=""}),(m,e)=>{const O=ge;return u.value&&n.value&&s.value!==void 0?(c(),g(a(ye),{key:0,fluid:"",class:"pa-0"},{default:r(()=>[o(a(F),{dense:""},{default:r(()=>[o(a(M),{class:"ml-2"},{default:r(()=>[o(a(W),{variant:"outlined",color:C.value?"error":"grey",class:"pa-0",style:z(`max-height: ${E.value-8}px;overflow-y: auto;`)},{default:r(()=>[o(a(pe),{density:"compact",color:"surface"},{default:r(()=>[(c(),ae(le,null,te(y,t=>o(a(h),{key:t.value,class:"text-none font-weight-bold ml-2",variant:p.value===t.value?"flat":"text",active:p.value===t.value,color:p.value===t.value?"primary":"",onClick:b=>p.value=t.value},{default:r(()=>[k($(t.title),1)]),_:2},1032,["variant","active","color","onClick"])),64)),o(a(I)),o(a(h),{icon:"",color:"primary",class:"mr-2",onClick:G},{default:r(()=>[d.value==="light"?(c(),g(a(A),{key:0,icon:"mdi-weather-night"})):(c(),g(a(A),{key:1,icon:"mdi-weather-sunny"}))]),_:1})]),_:1}),o(a(ce)),o(a(re),{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t)},{default:r(()=>[o(a(J),{value:"schema"},{default:r(()=>[o(O,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),"default-language":"yaml","onUpdate:parseError":e[1]||(e[1]=t=>f("schema",t))},null,8,["modelValue"])]),_:1}),o(a(J),{value:"options"},{default:r(()=>[o(O,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value=t),"default-language":"yaml","onUpdate:parseError":e[3]||(e[3]=t=>f("options",t))},null,8,["modelValue"])]),_:1}),o(a(J),{value:"data"},{default:r(()=>[o(O,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value=t),"onUpdate:parseError":e[5]||(e[5]=t=>f("schema",t))},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),C.value?(c(),g(a(W),{key:0,color:"error",variant:"text",class:"pa-2"},{default:r(()=>[D("pre",Ve,$(C.value),1)]),_:1})):j("",!0)]),_:1},8,["color","style"])]),_:1}),o(a(M),{class:"pr-3"},{default:r(()=>[o(a(H),{style:z(`max-height: ${E.value-8}px;overflow-y: auto;`),rounded:"",border:"sm"},{default:r(()=>[o(a(se),{theme:d.value,"with-background":""},{default:r(()=>[i.value?(c(),g(a(de),{key:0,ref_key:"form",ref:L,modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=t=>N.value=t),class:"mx-3 mt-3"},{default:r(()=>[o(a(me),oe({modelValue:s.value,"onUpdate:modelValue":e[7]||(e[7]=t=>s.value=t)},i.value),{"custom-textarea":r(({node:t,statefulLayout:b})=>[D("textarea",{value:t.data,style:{border:"1px solid red"},placeholder:"A custom textarea",onInput:K=>b.input(t,K.target.value)},null,40,he)]),"custom-message":r(({node:t})=>[k(" This message is defined in a slot (key="+$(t.key)+") ",1)]),_:1},16,["modelValue"]),o(a(F),{class:"ma-0"},{default:r(()=>[o(a(I)),o(a(h),{color:q.value,flat:"",class:"my-2",onClick:e[8]||(e[8]=t=>{var b;return(b=L.value)==null?void 0:b.validate()})},{default:r(()=>e[10]||(e[10]=[k(" Validate ")])),_:1},8,["color"])]),_:1})]),_:1},8,["modelValue"])):j("",!0)]),_:1},8,["theme"])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})):j("",!0)}}};export{We as default};
