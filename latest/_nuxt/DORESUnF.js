import{P as G,Y as J}from"./DO98xOt2.js";import{P as C}from"./DTiBFlNp.js";import{a as q,V as k}from"./uyd1_TeY.js";import{a as I}from"./DX1LYnmW.js";import{r as p,T,t as y,F as S,A as o,z as t,G as l,B as g,H as _,o as Y,j as O,X as K,Y as R,M as A,v as X,L as Q,K as Z,x as B,y as U,W as ee}from"./aEGA0wpu.js";import{h as ae,w as le,u as te,d as L,j as oe,l as $,e as re,_ as se,V as M,s as ue,t as ne}from"./WvIn8206.js";import{u as ie}from"./XZ82oDC1.js";import{V as z}from"./DKreF3XH.js";import{e as de,V as me}from"./Beq23Yiy.js";import{V as F}from"./Vwrxkeyk.js";import{V as W}from"./qsAqAAdY.js";import{V as ve}from"./Cz3xdDKN.js";import"./DuRfddoq.js";import"./CRlVbfe7.js";import"./CQZMHC8O.js";import"./C9e8wTuN.js";import"./BMi2Fb-F.js";import"./CbMS6AMa.js";/* empty css        */const pe={__name:"object-editor",props:{modelValue:{type:[Object,String,Number,Boolean,Array],required:!0},readonly:{type:Boolean,default:!1}},emits:["update:modelValue","update:parseError"],setup(E,{emit:h}){C.manual=!0;const u=E,n=h,s=p({}),v=p("json"),d=p("{}"),N=(i,r)=>(r=r??v.value,r==="yaml"?J.parse(i):JSON.parse(i)),c=(i,r)=>(r=r??v.value,r==="yaml"?J.stringify(i):JSON.stringify(i,null,2));T(v,()=>{d.value=c(s.value)});const V=i=>{try{s.value=N(i),n("update:modelValue",s.value),n("update:parseError",null)}catch(r){n("update:parseError",r.message)}};T(()=>u.modelValue,()=>{u.modelValue!==s.value&&(s.value=JSON.parse(JSON.stringify(u.modelValue)),d.value=c(s.value))},{immediate:!0});const x=i=>C.highlight(i,C.languages[v.value],v.value);return(i,r)=>(y(),S(l(ae),{style:{position:"relative","background-color":"white"}},{default:o(()=>[t(l(q),{class:"rounded-0 rounded-bs-xl",rounded:"bs",density:"compact",variant:"elevated",elevation:"1",theme:"light",style:{position:"absolute",top:"0",right:"0","z-index":"200",height:"24px"}},{default:o(()=>[t(l(k),{size:"small",color:v.value==="json"?"primary":"",onClick:r[0]||(r[0]=f=>v.value="json")},{default:o(()=>[g(" JSON ")]),_:1},8,["color"]),t(l(k),{size:"small",color:v.value==="yaml"?"primary":"",onClick:r[1]||(r[1]=f=>v.value="yaml")},{default:o(()=>[g(" YAML ")]),_:1},8,["color"]),E.readonly?_("",!0):(y(),S(l(k),{key:0,size:"small",onClick:r[2]||(r[2]=f=>d.value=c(s.value))},{default:o(()=>[t(l(I),null,{default:o(()=>[g("mdi-format-align-left")]),_:1})]),_:1}))]),_:1}),t(l(G),{modelValue:d.value,"onUpdate:modelValue":[r[3]||(r[3]=f=>d.value=f),V],class:"vjsf-code-editor py-2",style:{"min-height":"200px"},highlight:x,"line-numbers":"",readonly:E.readonly},null,8,["modelValue","readonly"])]),_:1}))}},fe={class:"text-caption"},ce=["value","onInput"],Je={__name:"editor",setup(E){const h=de[0].examples[0],u=p(null),n=p(null),s=p(null);Y(()=>{const m=window.localStorage.getItem("vjsf-editor-state");if(m){const a=JSON.parse(m);u.value=a.schema,n.value=a.options??{},s.value=a.data??{}}else u.value=h.schema,n.value=h.options??{},s.value=h.data??{};le([u,n,s],()=>{window.localStorage.setItem("vjsf-editor-state",JSON.stringify({schema:u.value,options:n.value,data:s.value}))},{debounce:500,immediate:!0})});const v=[{value:"schema",title:"Schema"},{value:"options",title:"Options"},{value:"data",title:"Data"}],d=p("schema"),{height:N}=te(),c=O(()=>N.value-56),V=p({}),x=p(null);T([u,n],()=>{if(!n.value||!u.value)return;let m;try{m=ue(u.value,{...ne,...n.value,components:{[z.info.name]:z.info}}),V.value=m.validationErrors}catch(a){V.value={"":[a.message]}}Object.keys(V.value).length||(x.value={options:{...n.value,plugins:[z]},schema:u.value})},{immediate:!0});const i=K({}),r=(m,a)=>{a?i[m]=a:delete i[m]},f=O(()=>{const m={...i,...V.value};return Object.keys(m).length?J.stringify(m).trim():""}),P=p(null),j=p(null),D=O(()=>j.value===!1?"error":j.value===!0?"success":"default");return ie({title:"VJSF - Editor"}),Y(()=>{document.getElementsByTagName("html")[0].style.overflowY="hidden"}),R(()=>{document.getElementsByTagName("html")[0].style.overflowY=""}),(m,a)=>{const b=pe;return u.value&&n.value&&s.value!==void 0?(y(),S(l(ve),{key:0,fluid:"",class:"pa-0"},{default:o(()=>[t(l(M),{dense:""},{default:o(()=>[t(l(L),{class:"ml-2"},{default:o(()=>[t(l(F),{variant:"outlined",color:f.value?"error":"grey",class:"pa-0",style:A(`max-height: ${c.value-8}px;overflow-y: auto;`)},{default:o(()=>[t(l(me),{density:"compact"},{default:o(()=>[(y(),X(Z,null,Q(v,e=>t(l(k),{key:e.value,class:"text-none font-weight-bold",size:"small",variant:d.value===e.value?"flat":"text",active:d.value===e.value,color:d.value===e.value?"primary":"",onClick:w=>d.value=e.value},{default:o(()=>[g(U(e.title),1)]),_:2},1032,["variant","active","color","onClick"])),64)),t(l(W))]),_:1}),t(l(oe),{modelValue:d.value,"onUpdate:modelValue":a[6]||(a[6]=e=>d.value=e)},{default:o(()=>[t(l($),{value:"schema"},{default:o(()=>[t(b,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),"onUpdate:parseError":a[1]||(a[1]=e=>r("schema",e))},null,8,["modelValue"])]),_:1}),t(l($),{value:"options"},{default:o(()=>[t(b,{modelValue:n.value,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value=e),"onUpdate:parseError":a[3]||(a[3]=e=>r("options",e))},null,8,["modelValue"])]),_:1}),t(l($),{value:"data"},{default:o(()=>[t(b,{modelValue:s.value,"onUpdate:modelValue":a[4]||(a[4]=e=>s.value=e),"onUpdate:parseError":a[5]||(a[5]=e=>r("schema",e))},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),f.value?(y(),S(l(F),{key:0,color:"error",variant:"text",class:"pa-2"},{default:o(()=>[B("pre",fe,U(f.value),1)]),_:1})):_("",!0)]),_:1},8,["color","style"])]),_:1}),t(l(L),null,{default:o(()=>[B("div",{style:A(`max-height: ${c.value-8}px;overflow-y: auto;`)},[x.value?(y(),S(l(re),{key:0,ref_key:"form",ref:P,modelValue:j.value,"onUpdate:modelValue":a[9]||(a[9]=e=>j.value=e),class:"mr-4"},{default:o(()=>[t(l(se),ee({modelValue:s.value,"onUpdate:modelValue":a[7]||(a[7]=e=>s.value=e)},x.value),{"custom-textarea":o(({node:e,statefulLayout:w})=>[B("textarea",{value:e.data,style:{border:"1px solid red"},placeholder:"A custom textarea",onInput:H=>w.input(e,H.target.value)},null,40,ce)]),"custom-message":o(({node:e})=>[g(" This message is defined in a slot (key="+U(e.key)+") ",1)]),_:1},16,["modelValue"]),t(l(M),{class:"ma-0"},{default:o(()=>[t(l(W)),t(l(k),{color:D.value,flat:"",class:"ma-2",onClick:a[8]||(a[8]=e=>{var w;return(w=P.value)==null?void 0:w.validate()})},{default:o(()=>[g(" Validate ")]),_:1},8,["color"])]),_:1})]),_:1},8,["modelValue"])):_("",!0)],4)]),_:1})]),_:1})]),_:1})):_("",!0)}}};export{Je as default};
