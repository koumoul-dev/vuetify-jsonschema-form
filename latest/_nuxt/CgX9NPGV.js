import{Y as P}from"./rESElKdt.js";import{P as $}from"./CN5uW8HJ.js";import{P as X,c as Z}from"./DlUJLJn6.js";import{d as ee,V as h}from"./CKsZhOIL.js";import{r as v,ab as C,t as c,D as g,A as r,z as o,E as t,B as k,F as j,K as z,o as M,i as J,aI as ae,aM as te,v as le,J as oe,I as re,x as Y,y as N,a0 as se}from"./Db_1TMCl.js";import{V as A}from"./DfYTdF8c.js";import{V as H,a as ue,b as T,c as ne}from"./CqTL17UF.js";import{w as ie,u as de,a as me}from"./CHo-MoSC.js";import{b as ve,_ as pe}from"./C0rtkL2H.js";import{a as D,V as F,b as _}from"./Cj8-eSAV.js";import{e as fe,a as ce,V as I}from"./BntawHgc.js";import{u as ye}from"./Cz6rNa9F.js";import{V as W}from"./B5Lx5vdX.js";import{d as ge}from"./Q1G-_FWo.js";import{V as Ve}from"./BDmTkypO.js";import"./DIu7GdWc.js";import"./BosuxZz1.js";import"./kY6r_Lxp.js";import"./BUIuSAzP.js";import"./SUUwKWEo.js";import"./Dlb1JjQX.js";import"./C69xQ0sX.js";import"./DDAE1LAy.js";import"./CbazRz8m.js";/* empty css        */const he={__name:"object-editor",props:{modelValue:{type:[Object,String,Number,Boolean,Array],required:!0},readonly:{type:Boolean,default:!1},defaultLanguage:{type:String,default:"json"}},emits:["update:modelValue","update:parseError"],setup(E,{emit:x}){$.manual=!0;const u=E,n=x,s=v({}),d=v(u.defaultLanguage),y=v("{}"),p=(i,l)=>(l=l??d.value,l==="yaml"?P.parse(i):JSON.parse(i)),w=(i,l)=>(l=l??d.value,l==="yaml"?P.stringify(i):JSON.stringify(i,null,2));C(d,()=>{y.value=w(s.value)});const U=i=>{try{s.value=p(i),n("update:modelValue",s.value),n("update:parseError",null)}catch(l){n("update:parseError",l.message)}};C(()=>u.modelValue,()=>{u.modelValue!==s.value&&(s.value=JSON.parse(JSON.stringify(u.modelValue)),y.value=w(s.value))},{immediate:!0});const V=i=>$.highlight(i,$.languages[d.value],d.value);return(i,l)=>(c(),g(t(H),{style:{position:"relative","background-color":"white"}},{default:r(()=>[o(t(ee),{class:"rounded-0 rounded-bs-xl",rounded:"bs",density:"compact",variant:"elevated",elevation:"1",style:{position:"absolute",top:"0",right:"0","z-index":"200",height:"24px"}},{default:r(()=>[o(t(h),{size:"small",color:d.value==="json"?"primary":"",onClick:l[0]||(l[0]=f=>d.value="json")},{default:r(()=>l[4]||(l[4]=[k(" JSON ")])),_:1},8,["color"]),o(t(h),{size:"small",color:d.value==="yaml"?"primary":"",onClick:l[1]||(l[1]=f=>d.value="yaml")},{default:r(()=>l[5]||(l[5]=[k(" YAML ")])),_:1},8,["color"]),E.readonly?j("",!0):(c(),g(t(h),{key:0,size:"small",onClick:l[2]||(l[2]=f=>y.value=w(s.value))},{default:r(()=>[o(t(A),null,{default:r(()=>l[6]||(l[6]=[k("mdi-format-align-left")])),_:1})]),_:1}))]),_:1}),o(t(X),{modelValue:y.value,"onUpdate:modelValue":[l[3]||(l[3]=f=>y.value=f),U],class:"vjsf-code-editor py-2",style:z(`min-height:200px; background-color: ${i.$vuetify.theme.current.colors.background}`),highlight:V,"line-numbers":"",readonly:E.readonly},null,8,["modelValue","style","readonly"])]),_:1}))}},ke={class:"text-caption"},xe=["value","onInput"],qe={__name:"editor",setup(E){const x=fe[0].examples[0],u=v(null),n=v(null),s=v(null),d=v("light");M(()=>{const m=window.localStorage.getItem("vjsf-editor-state");if(m){const e=JSON.parse(m);u.value=e.schema,n.value=e.options??{},s.value=e.data??{}}else u.value=x.schema,n.value=x.options??{},s.value=x.data??{};ie([u,n,s],()=>{window.localStorage.setItem("vjsf-editor-state",JSON.stringify({schema:u.value,options:n.value,data:s.value}))},{debounce:500,immediate:!0})});const y=[{value:"schema",title:"Schema"},{value:"options",title:"Options"},{value:"data",title:"Data"}],p=v("schema"),{height:w}=de(),U=J(()=>w.value-56),V=v({}),i=v(null);C([u,n],()=>{if(!n.value||!u.value)return;let m;try{m=Z(u.value,{...me,...n.value,components:{[_.info.name]:_.info}}),V.value=m.validationErrors}catch(e){V.value={"":[e.message]}}Object.keys(V.value).length||(i.value={options:{...n.value,plugins:[_]},schema:u.value})},{immediate:!0});const l=ae({}),f=(m,e)=>{e?l[m]=e:delete l[m]},O=J(()=>{const m={...l,...V.value};return Object.keys(m).length?P.stringify(m).trim():""}),L=v(null),S=v(null),q=J(()=>S.value===!1?"error":S.value===!0?"success":"default"),G=()=>{d.value=d.value==="light"?"dark":"light"},K=m=>{},R=m=>{};return C(S,()=>{}),ye({title:"VJSF - Editor"}),M(()=>{document.getElementsByTagName("html")[0].style.overflowY="hidden"}),te(()=>{document.getElementsByTagName("html")[0].style.overflowY=""}),(m,e)=>{const B=he;return n.value&&s.value!==void 0?(c(),g(t(Ve),{key:0,fluid:"",class:"pa-0"},{default:r(()=>[o(t(F),{dense:""},{default:r(()=>[o(t(D),{class:"ml-2"},{default:r(()=>[o(t(W),{variant:"outlined",color:O.value?"error":"grey",class:"pa-0",style:z(`max-height: ${U.value-8}px;overflow-y: auto;`)},{default:r(()=>[o(t(ce),{density:"compact",color:"surface"},{default:r(()=>[(c(),le(re,null,oe(y,a=>o(t(h),{key:a.value,class:"text-none font-weight-bold ml-2",variant:p.value===a.value?"flat":"text",active:p.value===a.value,color:p.value===a.value?"primary":"",onClick:b=>p.value=a.value},{default:r(()=>[k(N(a.title),1)]),_:2},1032,["variant","active","color","onClick"])),64)),o(t(I)),o(t(h),{icon:"",color:"primary",class:"mr-2",onClick:G},{default:r(()=>[d.value==="light"?(c(),g(t(A),{key:0,icon:"mdi-weather-night"})):(c(),g(t(A),{key:1,icon:"mdi-weather-sunny"}))]),_:1})]),_:1}),o(t(ge)),o(t(ue),{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value=a)},{default:r(()=>[o(t(T),{value:"schema"},{default:r(()=>[o(B,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),"default-language":"yaml","onUpdate:parseError":e[1]||(e[1]=a=>f("schema",a))},null,8,["modelValue"])]),_:1}),o(t(T),{value:"options"},{default:r(()=>[o(B,{modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value=a),"default-language":"yaml","onUpdate:parseError":e[3]||(e[3]=a=>f("options",a))},null,8,["modelValue"])]),_:1}),o(t(T),{value:"data"},{default:r(()=>[o(B,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value=a),"onUpdate:parseError":e[5]||(e[5]=a=>f("schema",a))},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),O.value?(c(),g(t(W),{key:0,color:"error",variant:"text",class:"pa-2"},{default:r(()=>[Y("pre",ke,N(O.value),1)]),_:1})):j("",!0)]),_:1},8,["color","style"])]),_:1}),o(t(D),{class:"pr-3"},{default:r(()=>[o(t(H),{style:z(`max-height: ${U.value-8}px;overflow-y: auto;`),rounded:"",border:"sm"},{default:r(()=>[o(t(ne),{theme:d.value,"with-background":""},{default:r(()=>[i.value?(c(),g(t(ve),{key:0,ref_key:"form",ref:L,modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=a=>S.value=a),class:"mx-3 mt-3"},{default:r(()=>[o(t(pe),se({modelValue:s.value,"onUpdate:modelValue":e[7]||(e[7]=a=>s.value=a)},i.value,{"onUpdate:state":R,"onUpdate:modelValue":K}),{"custom-textarea":r(({node:a,statefulLayout:b})=>[Y("textarea",{value:a.data,style:{border:"1px solid red"},placeholder:"A custom textarea",onInput:Q=>b.input(a,Q.target.value)},null,40,xe)]),"custom-message":r(({node:a})=>[k(" This message is defined in a slot (key="+N(a.key)+", data="+N(a.data)+") ",1)]),_:1},16,["modelValue"]),o(t(F),{class:"ma-0"},{default:r(()=>[o(t(I)),o(t(h),{color:q.value,flat:"",class:"my-2",onClick:e[8]||(e[8]=a=>{var b;return(b=L.value)==null?void 0:b.validate()})},{default:r(()=>e[10]||(e[10]=[k(" Validate ")])),_:1},8,["color"])]),_:1})]),_:1},8,["modelValue"])):j("",!0)]),_:1},8,["theme"])]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})):j("",!0)}}};export{qe as default};
