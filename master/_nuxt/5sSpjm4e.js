import{d as X,h as y,V as W,o as G,Y as tt,a2 as et,a3 as it,a4 as I,a5 as U,a6 as nt,a7 as m,r as D,j as M,a8 as O,a9 as rt,E as st}from"./DMJ_6nyb.js";function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},E.apply(this,arguments)}var at=13,ot=9,lt=8,ut=89,C=90,ct=77,A=57,F=219,z=222,V=192,ht=27,B=100,dt=3e3,ft=typeof window<"u"&&navigator&&/Win/i.test(navigator.platform),w=typeof window<"u"&&navigator&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),Mt=X({props:{lineNumbers:{type:Boolean,default:!1},autoStyleLineNumbers:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},modelValue:{type:String,default:""},highlight:{type:Function,required:!0},tabSize:{type:Number,default:2},insertSpaces:{type:Boolean,default:!0},ignoreTabKey:{type:Boolean,default:!1},placeholder:{type:String,default:""}},data:function(){return{capture:!0,history:{stack:[],offset:-1},lineNumbersHeight:"20px",codeData:""}},watch:{modelValue:{immediate:!0,handler:function(t){t?this.codeData=t:this.codeData=""}},content:{immediate:!0,handler:function(){var t=this;this.lineNumbers&&this.$nextTick(function(){t.setLineNumbersHeight()})}},lineNumbers:function(){var t=this;this.$nextTick(function(){t.styleLineNumbers(),t.setLineNumbersHeight()})}},computed:{isEmpty:function(){return this.codeData.length===0},content:function(){var t=this.highlight(this.codeData)+"<br />";return t},lineNumbersCount:function(){var t=this.codeData.split(/\r\n|\n/).length;return t}},mounted:function(){this._recordCurrentState(),this.styleLineNumbers()},methods:{setLineNumbersHeight:function(){this.lineNumbersHeight=getComputedStyle(this.$refs.pre).height},styleLineNumbers:function(){if(!(!this.lineNumbers||!this.autoStyleLineNumbers)){var t=this.$refs.pre,i=this.$el.querySelector(".prism-editor__line-numbers"),n=window.getComputedStyle(t);this.$nextTick(function(){var a="border-top-left-radius",u="border-bottom-left-radius";if(i){i.style[a]=n[a],i.style[u]=n[u],t.style[a]="0",t.style[u]="0";var l=["background-color","margin-top","padding-top","font-family","font-size","line-height"];l.forEach(function(r){i.style[r]=n[r]}),i.style["margin-bottom"]="-"+n["padding-top"]}})}},_recordCurrentState:function(){var t=this.$refs.textarea;if(t){var i=t.value,n=t.selectionStart,a=t.selectionEnd;this._recordChange({value:i,selectionStart:n,selectionEnd:a})}},_getLines:function(t,i){return t.substring(0,i).split(`
`)},_applyEdits:function(t){var i=this.$refs.textarea,n=this.history.stack[this.history.offset];n&&i&&(this.history.stack[this.history.offset]=E({},n,{selectionStart:i.selectionStart,selectionEnd:i.selectionEnd})),this._recordChange(t),this._updateInput(t)},_recordChange:function(t,i){i===void 0&&(i=!1);var n=this.history,a=n.stack,u=n.offset;if(a.length&&u>-1){this.history.stack=a.slice(0,u+1);var l=this.history.stack.length;if(l>B){var r=l-B;this.history.stack=a.slice(r,l),this.history.offset=Math.max(this.history.offset-r,0)}}var s=Date.now();if(i){var o=this.history.stack[this.history.offset];if(o&&s-o.timestamp<dt){var c,h,f=/[^a-z0-9]([a-z0-9]+)$/i,d=(c=this._getLines(o.value,o.selectionStart).pop())===null||c===void 0?void 0:c.match(f),p=(h=this._getLines(t.value,t.selectionStart).pop())===null||h===void 0?void 0:h.match(f);if(d&&p&&p[1].startsWith(d[1])){this.history.stack[this.history.offset]=E({},t,{timestamp:s});return}}}this.history.stack.push(E({},t,{timestamp:s})),this.history.offset++},_updateInput:function(t){var i=this.$refs.textarea;i&&(i.value=t.value,i.selectionStart=t.selectionStart,i.selectionEnd=t.selectionEnd,this.$emit("update:modelValue",t.value))},handleChange:function(t){var i=t.target,n=i.value,a=i.selectionStart,u=i.selectionEnd;this._recordChange({value:n,selectionStart:a,selectionEnd:u},!0),this.$emit("update:modelValue",n)},_undoEdit:function(){var t=this.history,i=t.stack,n=t.offset,a=i[n-1];a&&(this._updateInput(a),this.history.offset=Math.max(n-1,0))},_redoEdit:function(){var t=this.history,i=t.stack,n=t.offset,a=i[n+1];a&&(this._updateInput(a),this.history.offset=Math.min(n+1,i.length-1))},handleKeyDown:function(t){var i=this.tabSize,n=this.insertSpaces,a=this.ignoreTabKey;if(this.$emit("keydown",t),!t.defaultPrevented){t.keyCode===ht&&(t.target.blur(),this.$emit("blur",t));var u=t.target,l=u.value,r=u.selectionStart,s=u.selectionEnd,o=(n?" ":"	").repeat(i);if(t.keyCode===ot&&!a&&this.capture)if(t.preventDefault(),t.shiftKey){var c=this._getLines(l,r),h=c.length-1,f=this._getLines(l,s).length-1,d=l.split(`
`).map(function(g,b){return b>=h&&b<=f&&g.startsWith(o)?g.substring(o.length):g}).join(`
`);if(l!==d){var p=c[h];this._applyEdits({value:d,selectionStart:p.startsWith(o)?r-o.length:r,selectionEnd:s-(l.length-d.length)})}}else if(r!==s){var L=this._getLines(l,r),_=L.length-1,P=this._getLines(l,s).length-1,Z=L[_];this._applyEdits({value:l.split(`
`).map(function(g,b){return b>=_&&b<=P?o+g:g}).join(`
`),selectionStart:/\S/.test(Z)?r+o.length:r,selectionEnd:s+o.length*(P-_+1)})}else{var $=r+o.length;this._applyEdits({value:l.substring(0,r)+o+l.substring(s),selectionStart:$,selectionEnd:$})}else if(t.keyCode===lt){var q=r!==s,J=l.substring(0,r);if(J.endsWith(o)&&!q){t.preventDefault();var Y=r-o.length;this._applyEdits({value:l.substring(0,r-o.length)+l.substring(s),selectionStart:Y,selectionEnd:Y})}}else if(t.keyCode===at){if(r===s){var S=this._getLines(l,r).pop(),k=S==null?void 0:S.match(/^\s+/);if(k&&k[0]){t.preventDefault();var j=`
`+k[0],H=r+j.length;this._applyEdits({value:l.substring(0,r)+j+l.substring(s),selectionStart:H,selectionEnd:H})}}}else if(t.keyCode===A||t.keyCode===F||t.keyCode===z||t.keyCode===V){var v;t.keyCode===A&&t.shiftKey?v=["(",")"]:t.keyCode===F?t.shiftKey?v=["{","}"]:v=["[","]"]:t.keyCode===z?t.shiftKey?v=['"','"']:v=["'","'"]:t.keyCode===V&&!t.shiftKey&&(v=["`","`"]),r!==s&&v&&(t.preventDefault(),this._applyEdits({value:l.substring(0,r)+v[0]+l.substring(r,s)+v[1]+l.substring(s),selectionStart:r,selectionEnd:s+2}))}else(w?t.metaKey&&t.keyCode===C:t.ctrlKey&&t.keyCode===C)&&!t.shiftKey&&!t.altKey?(t.preventDefault(),this._undoEdit()):(w?t.metaKey&&t.keyCode===C&&t.shiftKey:ft?t.ctrlKey&&t.keyCode===ut:t.ctrlKey&&t.keyCode===C&&t.shiftKey)&&!t.altKey?(t.preventDefault(),this._redoEdit()):t.keyCode===ct&&t.ctrlKey&&(!w||t.shiftKey)&&(t.preventDefault(),this.capture=!this.capture)}}},render:function(){var t=this,i=y("div",{class:"prism-editor__line-width-calc",style:"height: 0px; visibility: hidden; pointer-events: none;"},"999"),n=y("div",{class:"prism-editor__line-numbers",style:{"min-height":this.lineNumbersHeight},"aria-hidden":"true"},[i,Array.from(Array(this.lineNumbersCount).keys()).map(function(r,s){return y("div",{class:"prism-editor__line-number token comment"},""+ ++s)})]),a=y("textarea",{ref:"textarea",onInput:this.handleChange,onKeydown:this.handleKeyDown,onClick:function(s){t.$emit("click",s)},onKeyup:function(s){t.$emit("keyup",s)},onFocus:function(s){t.$emit("focus",s)},onBlur:function(s){t.$emit("blur",s)},class:{"prism-editor__textarea":!0,"prism-editor__textarea--empty":this.isEmpty},spellCheck:"false",autocapitalize:"off",autocomplete:"off",autocorrect:"off","data-gramm":"false",placeholder:this.placeholder,"data-testid":"textarea",readonly:this.readonly,value:this.codeData}),u=y("pre",{ref:"pre",class:"prism-editor__editor","data-testid":"preview",innerHTML:this.content}),l=y("div",{class:"prism-editor__container"},[a,u]);return y("div",{class:"prism-editor-wrapper"},[this.lineNumbers&&n,l])}});function pt(e){return et()?(it(e),!0):!1}const K=new WeakMap,vt=(...e)=>{var t;const i=e[0],n=(t=I())==null?void 0:t.proxy;if(n==null&&!U())throw new Error("injectLocal must be called in setup");return n&&K.has(n)&&i in K.get(n)?K.get(n)[i]:nt(...e)},mt=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const yt=Object.prototype.toString,gt=e=>yt.call(e)==="[object Object]",R=()=>{};function bt(e,t){function i(...n){return new Promise((a,u)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(a).catch(u)})}return i}const Et=e=>e();function Ct(e,t={}){let i,n,a=R;const u=s=>{clearTimeout(s),a(),a=R};let l;return s=>{const o=m(e),c=m(t.maxWait);return i&&u(i),o<=0||c!==void 0&&c<=0?(n&&(u(n),n=null),Promise.resolve(s())):new Promise((h,f)=>{a=t.rejectOnCancel?f:h,l=s,c&&!n&&(n=setTimeout(()=>{i&&u(i),n=null,h(l())},c)),i=setTimeout(()=>{n&&u(n),n=null,h(s())},o)})}}function Q(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function _t(e){return I()}function N(e){return Array.isArray(e)?e:[e]}function St(e,t,i={}){const{eventFilter:n=Et,...a}=i;return W(e,bt(n,t),a)}function kt(e,t=!0,i){_t()?G(e,i):t?e():tt(e)}function xt(e,t,i={}){const{debounce:n=0,maxWait:a=void 0,...u}=i;return St(e,t,{...u,eventFilter:Ct(n,{maxWait:a})})}function wt(e,t,i){return W(e,t,{...i,immediate:!0})}const x=mt?window:void 0;function Kt(e){var t;const i=m(e);return(t=i==null?void 0:i.$el)!=null?t:i}function T(...e){const t=[],i=()=>{t.forEach(r=>r()),t.length=0},n=(r,s,o,c)=>(r.addEventListener(s,o,c),()=>r.removeEventListener(s,o,c)),a=M(()=>{const r=N(m(e[0])).filter(s=>s!=null);return r.every(s=>typeof s!="string")?r:void 0}),u=wt(()=>{var r,s;return[(s=(r=a.value)==null?void 0:r.map(o=>Kt(o)))!=null?s:[x].filter(o=>o!=null),N(m(a.value?e[1]:e[0])),N(st(a.value?e[2]:e[1])),m(a.value?e[3]:e[2])]},([r,s,o,c])=>{if(i(),!(r!=null&&r.length)||!(s!=null&&s.length)||!(o!=null&&o.length))return;const h=gt(c)?{...c}:c;t.push(...r.flatMap(f=>s.flatMap(d=>o.map(p=>n(f,d,p,h)))))},{flush:"post"}),l=()=>{u(),i()};return pt(i),l}function Nt(){const e=O(!1),t=I();return t&&G(()=>{e.value=!0},t),e}function Dt(e){const t=Nt();return M(()=>(t.value,!!e()))}const Ot=Symbol("vueuse-ssr-width");function Tt(){const e=U()?vt(Ot,null):null;return typeof e=="number"?e:void 0}function Wt(e,t={}){const{window:i=x,ssrWidth:n=Tt()}=t,a=Dt(()=>i&&"matchMedia"in i&&typeof i.matchMedia=="function"),u=D(typeof n=="number"),l=O(),r=O(!1),s=o=>{r.value=o.matches};return rt(()=>{if(u.value){u.value=!a.value;const o=m(e).split(",");r.value=o.some(c=>{const h=c.includes("not all"),f=c.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),d=c.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let p=!!(f||d);return f&&p&&(p=n>=Q(f[1])),d&&p&&(p=n<=Q(d[1])),h?!p:p});return}a.value&&(l.value=i.matchMedia(m(e)),r.value=l.value.matches)}),T(l,"change",s,{passive:!0}),M(()=>r.value)}function Lt(e={}){const{window:t=x,initialWidth:i=Number.POSITIVE_INFINITY,initialHeight:n=Number.POSITIVE_INFINITY,listenOrientation:a=!0,includeScrollbar:u=!0,type:l="inner"}=e,r=D(i),s=D(n),o=()=>{if(t)if(l==="outer")r.value=t.outerWidth,s.value=t.outerHeight;else if(l==="visual"&&t.visualViewport){const{width:h,height:f,scale:d}=t.visualViewport;r.value=Math.round(h*d),s.value=Math.round(f*d)}else u?(r.value=t.innerWidth,s.value=t.innerHeight):(r.value=t.document.documentElement.clientWidth,s.value=t.document.documentElement.clientHeight)};o(),kt(o);const c={passive:!0};if(T("resize",o,c),t&&l==="visual"&&t.visualViewport&&T(t.visualViewport,"resize",o,c),a){const h=Wt("(orientation: portrait)");W(h,()=>o())}return{width:r,height:s}}export{Mt as P,Lt as u,xt as w};
